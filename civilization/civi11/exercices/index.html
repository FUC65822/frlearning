<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>法语区练习</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- 主题颜色变量定义 --- */
        :root {
            /* 浅色模式 (默认) */
            --bg-primary: #f9fafb;      /* gray-50 */
            --bg-secondary: #ffffff;    /* white */
            --bg-tertiary: #f3f4f6;    /* gray-100 */
            --bg-accent: #eef2ff;       /* indigo-50 */
            --text-primary: #111827;    /* gray-900 */
            --text-secondary: #374151;  /* gray-700 */
            --text-muted: #6b7280;      /* gray-500 */
            --border-primary: #e5e7eb;  /* gray-200 */
            --border-secondary: #f3f4f6; /* gray-100 */
            --brand-primary: #4f46e5;   /* indigo-600 */
            --brand-secondary: #3b82f6; /* blue-500 */
        }

        html.dark {
            /* 深色模式 */
            --bg-primary: #111827;      /* gray-900 */
            --bg-secondary: #1f2937;    /* gray-800 */
            --bg-tertiary: #374151;    /* gray-700 */
            --bg-accent: #312e81;       /* indigo-900 */
            --text-primary: #f9fafb;    /* gray-50 */
            --text-secondary: #d1d5db;  /* gray-300 */
            --text-muted: #9ca3af;      /* gray-400 */
            --border-primary: #374151;  /* gray-700 */
            --border-secondary: #4b5563; /* gray-600 */
            --brand-primary: #6366f1;   /* indigo-500 */
            --brand-secondary: #60a5fa; /* blue-400 */
        }

        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-secondary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* 自定义滚动条样式 */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-tertiary); }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* 应用颜色变量 */
        .bg-primary { background-color: var(--bg-primary); }
        .bg-secondary { background-color: var(--bg-secondary); }
        .bg-tertiary { background-color: var(--bg-tertiary); }
        .bg-accent { background-color: var(--bg-accent); }
        .text-primary { color: var(--text-primary); }
        .text-secondary { color: var(--text-secondary); }
        .text-muted { color: var(--text-muted); }
        .border-primary { border-color: var(--border-primary); }
        .border-secondary { border-color: var(--border-secondary); }
        .text-brand-primary { color: var(--brand-primary); }
        .border-brand-secondary { border-color: var(--border-secondary); }
        .hover\:bg-accent:hover { background-color: var(--bg-accent); }
        .hover\:text-brand-primary:hover { color: var(--brand-primary); }

        /* 标记正确和错误的样式 */
        .correct-answer { color: #16a34a; }
        .incorrect-answer { color: #dc2626; }
        .correct-bg { background-color: #dcfce7; }
        .incorrect-bg { background-color: #fee2e2; }
        html.dark .correct-bg { background-color: #14532d; }
        html.dark .incorrect-bg { background-color: #7f1d1d; }

        /* 导航栏激活状态 */
        .nav-active {
            background-color: var(--bg-accent);
            color: var(--brand-primary);
            font-weight: 600;
        }

        /* 通用过渡效果 */
        .transitionable {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
        }
    </style>
</head>
<body class="transitionable">

    <!-- 移动端顶部导航栏 -->
    <header class="md:hidden sticky top-0 z-30 bg-secondary/80 backdrop-blur-sm border-b border-primary flex items-center justify-between p-4 transitionable">
        <button id="menu-toggle-btn" class="p-2 -ml-2">
            <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
        <h1 id="mobile-title" class="text-lg font-bold text-brand-primary">法语区练习</h1>
        <div id="mobile-score-container" class="text-sm font-semibold text-secondary transitionable text-right w-24"></div>
    </header>

    <div class="relative flex min-h-screen">
        <!-- 侧边导航栏 -->
        <aside id="sidebar" class="w-64 bg-secondary border-r border-primary p-4 md:p-6 transitionable transform -translate-x-full md:translate-x-0 md:sticky fixed top-0 h-screen z-40 flex flex-col">
            <div>
                <h1 id="main-title" class="text-2xl font-bold text-brand-primary mb-4 hidden md:block">法语区练习</h1>
                <button id="lang-switch-btn" class="w-full mb-2 px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 transition-colors shadow-sm text-sm">
                    切换语言 / Changer de langue
                </button>
                <button id="theme-toggle-btn" class="w-full mb-4 px-4 py-2 bg-tertiary text-secondary font-semibold rounded-lg hover:bg-accent transitionable">
                    <span class="flex items-center justify-center text-sm">
                        <svg id="theme-icon-sun" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                        <svg id="theme-icon-moon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                        <span id="theme-btn-text" class="ml-2"></span>
                    </span>
                </button>
                <nav id="navigation" class="space-y-2 overflow-y-auto" style="height: calc(100vh - 250px);"></nav>
            </div>
             <div id="desktop-score-container" class="mt-auto p-3 bg-tertiary rounded-lg text-center text-secondary font-semibold hidden md:block transitionable">
                <!-- Desktop score appears here -->
            </div>
        </aside>
        
        <!-- 遮罩层 -->
        <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-30 hidden md:hidden"></div>

        <!-- 主内容区域 -->
        <div class="flex flex-col flex-1">
            <main class="flex-1 p-4 md:p-8 lg:p-12">
                <div id="quiz-container">
                    <!-- 题目将由JS动态生成 -->
                </div>
            </main>

            <!-- 页脚 -->
            <footer class="text-center py-8 px-4 mt-auto">
                <p id="disclaimer-text" class="text-xs text-muted mb-2 transitionable"></p>
                <p id="copyright-text" class="text-sm text-secondary transitionable"></p>
            </footer>
        </div>
    </div>
    
    <!-- 浮动操作按钮 -->
    <div class="fixed bottom-4 right-4 z-20 flex flex-col items-center gap-2">
        <button id="check-answers-btn" class="w-36 px-4 py-2 bg-blue-600 text-white font-semibold rounded-full hover:bg-blue-700 transition-all shadow-lg text-sm">检查答案</button>
        <button id="reset-btn" class="w-36 px-4 py-2 bg-tertiary text-secondary font-semibold rounded-full hover:bg-accent transitionable shadow-lg text-sm">重置</button>
        <button id="show-answers-btn" class="w-36 px-4 py-2 bg-yellow-500 text-white font-semibold rounded-full hover:bg-yellow-600 transition-all shadow-lg text-sm">显示答案</button>
    </div>


    <!-- 确认弹窗 -->
    <div id="confirmation-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-secondary rounded-lg p-6 shadow-xl w-full max-w-md transitionable">
            <h3 id="modal-title" class="text-lg font-bold text-primary mb-4 transitionable">确认操作</h3>
            <p id="modal-message" class="text-secondary transitionable">确定要显示所有答案吗？您当前的作答记录将被清空。</p>
            <div class="mt-6 flex justify-end gap-4">
                <button id="modal-cancel-btn" class="px-4 py-2 bg-tertiary text-secondary rounded-md hover:bg-accent transitionable">取消</button>
                <button id="modal-confirm-btn" class="px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600">确定</button>
            </div>
        </div>
    </div>


    <script>
        // 存储所有题目数据，包含中法文
        const quizData = [
            {
                id: "maghreb",
                title: "11.1 LE MAGHREB", title_zh: "11.1 马格里布",
                sections: [
                    {
                        title: "Compréhension globale", title_zh: "整体理解",
                        questions: [
                            { q: "1. Quelle est la signification du nom << Maghreb >> ?", q_zh: "1. “Maghreb”这个名字是什么意思？", o: ["Le soleil levant", "La terre des hommes libres", "Le Couchant", "La mer"], o_zh: ["日出之地", "自由人的土地", "日落之地", "大海"], a: 2 },
                            { q: "2. Quels sont les trois pays qui composent le Maghreb ?", q_zh: "2. 组成马格里布的是哪三个国家？", o: ["Algérie, Tunisie, Égypte", "Algérie, Maroc, Tunisie", "Maroc, Libye, Algérie", "Libye, Égypte, Tunisie"], o_zh: ["阿尔及利亚、突尼斯、埃及", "阿尔及利亚、摩洛哥、突尼斯", "摩洛哥、利比亚、阿尔及利亚", "利比亚、埃及、突尼斯"], a: 1 },
                            { q: "3. Quel est le rôle du français dans les pays du Maghreb ?", q_zh: "3. 法语在马格里布国家扮演什么角色？", o: ["Il est la langue officielle", "Il est utilisé dans les affaires et l'éducation", "Il est la seule langue parlée", "Il est uniquement utilisé dans le cinéma"], o_zh: ["它是官方语言", "它被用于商业和教育", "它是唯一使用的语言", "它只在电影中使用"], a: 1 },
                            { q: "4. Quel est le lien entre la région du Maghreb et le christianisme occidental ?", q_zh: "4. 马格里布地区与西方基督教有什么联系？", o: ["La naissance du christianisme", "Le Christianisme est venu d'Algérie", "Saint-Augustin est originaire du Maghreb", "Le Maghreb est un lieu de pèlerinage chrétien"], o_zh: ["基督教的诞生", "基督教来自阿尔及利亚", "圣奥古斯丁来自马格里布", "马格里布是基督教的朝圣地"], a: 2 },
                            { q: "5. Qu'est-ce que le raï ?", q_zh: "5. “Raï”是什么？", o: ["Une danse populaire", "Une forme de musique traditionnelle", "Une langue parlée au Maghreb", "Un plat typique du Maghreb"], o_zh: ["一种流行舞蹈", "一种传统音乐形式", "马格里布地区的一种语言", "马格里布的一种特色菜"], a: 1 },
                        ]
                    },
                    {
                        title: "Compréhension détaillée", title_zh: "细节理解",
                        questions: [
                            { q: "1. Quelle chaîne de montagnes traverse le Maghreb sur plus de 2000 km ?", q_zh: "1. 哪条山脉横贯马格里布超过2000公里？", o: ["Les Alpes", "Le Mont Atlas", "La chaîne de l'Atlas", "Les Pyrénées"], o_zh: ["阿尔卑斯山脉", "阿特拉斯山", "阿特拉斯山脉", "比利牛斯山脉"], a: 2 },
                            { q: "2. Quelles grandes villes sont mentionnées dans le texte comme étant importantes dans le Maghreb ?", q_zh: "2. 文中提到了哪些马格里布的重要大城市？", o: ["Tunis, Alger, Rabat, Casablanca", "Rabat, Casablanca, Le Caire, Marrakech", "Alger, Tunis, Marseille, Casablanca", "Tunis, Rabat, Paris, Marrakech"], o_zh: ["突尼斯、阿尔及尔、拉巴特、卡萨布兰卡", "拉巴特、卡萨布兰卡、开罗、马拉喀什", "阿尔及尔、突尼斯、马赛、卡萨布兰卡", "突尼斯、拉巴特、巴黎、马拉喀什"], a: 0 },
                            { q: "3. De quel pays est originaire le chanteur Khaled ?", q_zh: "3. 歌手Khaled来自哪个国家？", o: ["Maroc", "Algérie", "Tunisie", "Libye"], o_zh: ["摩洛哥", "阿尔及利亚", "突尼斯", "利比亚"], a: 1 },
                            { q: "4. Quel est le rôle du Sahara dans l'économie du Maghreb ?", q_zh: "4. 撒哈拉沙漠在马格里布经济中扮演什么角色？", o: ["Il est une source de pétrole et de gaz", "Il est un site touristique uniquement", "Il est utilisé pour l'agriculture", "Il est lié à la culture musicale"], o_zh: ["它是石油和天然气的来源", "它只是一个旅游景点", "它被用于农业", "它与音乐文化有关"], a: 0 },
                            { q: "5. Pourquoi le français est-il important dans la culture littéraire du Maghreb ?", q_zh: "5. 为什么法语在马格里布的文学文化中很重要？", o: ["Il est la langue de la création littéraire", "Il est la langue des religions", "Il est parlé uniquement par les écrivains", "Il est utilisé pour la poésie seulement"], o_zh: ["它是文学创作的语言", "它是宗教的语言", "它只被作家使用", "它只用于诗歌"], a: 0 },
                        ]
                    },
                    {
                        title: "Vocabulaire", title_zh: "词汇",
                        questions: [
                            { q: "1. Que signifie le mot \"raï\" ?", q_zh: "1. “raï”这个词是什么意思？", o: ["Un type de danse", "Une musique traditionnelle", "Une personne", "Un style de peinture"], o_zh: ["一种舞蹈", "一种传统音乐", "一个人", "一种绘画风格"], a: 1 },
                            { q: "2. Complétez la phrase: Le Maghreb est une région entre la ______ et le désert.", q_zh: "2. 填空：马格里布是位于 ______ 和沙漠之间的一个地区。", o: ["Mer", "Forêt", "Montagne", "Ville"], o_zh: ["大海", "森林", "山脉", "城市"], a: 0, type: 'fill' },
                            { q: "3. Reliez les expressions avec leur signification:", q_zh: "3. 将表达与其含义连接起来：", type: 'match', items: ["A. Tamazgha", "B. Maghreb", "C. Raï"], items_zh: ["A. Tamazgha", "B. Maghreb", "C. Raï"], matches: ["1) Le Couchant", "2) Terre des hommes libres", "3) Musique populaire"], matches_zh: ["1) 日落之地", "2) 自由人的土地", "3) 流行音乐"], a: [1, 0, 2] },
                            { q: "4. Vrai/Faux: Le français est la langue officielle dans les pays du Maghreb.", q_zh: "4. 正确/错误：法语是马格里布国家的官方语言。", type: 'tf', a: false },
                            { q: "5. Quel mot désigne l'action d'influencer une culture de manière importante ?", q_zh: "5. 哪个词指对一种文化产生重要影响的行为？", o: ["Coloniser", "Civiliser", "Influencer", "Arabiser"], o_zh: ["殖民", "使文明", "影响", "阿拉伯化"], a: 2 },
                        ]
                    }
                ]
            },
            // ... The rest of the data is structured similarly ...
            {
                id: "proche-orient", title: "11.2 LE PROCHE-ORIENT", title_zh: "11.2 近东地区",
                sections: [
                    { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Quelles sont les régions principales du Proche-Orient mentionnées dans le texte ?", q_zh: "1. 文中提到的近东主要地区有哪些？", o: ["La Turquie, le Liban, Israël", "L'Égypte, le Maroc, la Syrie", "L'Iran, la Turquie, la Syrie", "Le Liban, Israël, la Libye"], o_zh: ["土耳其、黎巴嫩、以色列", "埃及、摩洛哥、叙利亚", "伊朗、土耳其、叙利亚", "黎巴嫩、以色列、利比亚"], a: 0 },
                            { q: "2. Qu'est-ce qui lie la France aux pays du Proche-Orient ?", q_zh: "2. 是什么将法国与近东国家联系起来？", o: ["L'histoire des croisades", "L'exportation de pétrole", "La diplomatie économique", "La colonisation uniquement"], o_zh: ["十字军东征的历史", "石油出口", "经济外交", "仅仅是殖民"], a: 0 },
                            { q: "3. Quel est le rôle du français dans la culture du Proche-Orient ?", q_zh: "3. 法语在近东文化中扮演什么角色？", o: ["Il est une langue officielle dans tous les pays", "Il est la langue de l'administration", "Il est une langue culturelle, dans les universités et institutions", "Il est réservé aux gouvernements"], o_zh: ["它是所有国家的官方语言", "它是行政语言", "它是一种文化语言，用于大学和机构", "它仅供政府使用"], a: 2 },
                            { q: "4. Quelle est la principale raison de la présence du français au Proche-Orient ?", q_zh: "4. 法语在近东存在的主要原因是什么？", o: ["Les accords commerciaux avec la France", "L'influence historique de la France", "Le tourisme", "La coopération militaire"], o_zh: ["与法国的贸易协定", "法国的历史影响", "旅游业", "军事合作"], a: 1 },
                            { q: "5. Quel écrivain est mentionné comme ayant contribué à la littérature du Proche-Orient ?", q_zh: "5. 哪位作家被提及为近东文学做出了贡献？", o: ["Albert Memmi", "Gabriel García Márquez", "Dany Laferrière", "Pierre Loti"], o_zh: ["阿尔贝·梅米", "加夫列尔·加西亚·马尔克斯", "丹尼·拉费里埃", "皮埃尔·洛蒂"], a: 3 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Qui a été reconnu comme protecteur des chrétiens par l'Empire Ottoman ?", q_zh: "1. 谁被奥斯曼帝国承认为基督徒的保护者？", o: ["François Ier", "Napoléon Bonaparte", "Louis XIV", "Soliman le Magnifique"], o_zh: ["弗朗索瓦一世", "拿破仑·波拿巴", "路易十四", "苏莱曼大帝"], a: 0 },
                            { q: "2. Quel événement a marqué la diplomatie de la France au Proche-Orient au XIXe siècle ?", q_zh: "2. 19世纪法国在近东的外交标志性事件是什么？", o: ["La création du Canal de Suez", "La guerre des Croisades", "Le début des croisades en 1096", "L'indépendance des États arabes"], o_zh: ["苏伊士运河的开凿", "十字军战争", "1096年十字军东征开始", "阿拉伯国家的独立"], a: 0 },
                            { q: "3. Quel rôle joue le français dans les pays du Proche-Orient aujourd'hui ?", q_zh: "3. 今天法语在近东国家扮演什么角色？", o: ["Il est une langue scolaire uniquement", "Il est une langue pour les affaires et la diplomatie", "Il est une langue religieuse", "Il est uniquement utilisé dans le cinéma"], o_zh: ["它只是一种学校语言", "它是一种用于商业和外交的语言", "它是一种宗教语言", "它只在电影中使用"], a: 1 },
                            { q: "4. Quelle grande université francophone est située au Liban ?", q_zh: "4. 哪所著名的法语大学位于黎巴嫩？", o: ["Université de Damas", "Université Saint-Joseph à Beyrouth", "Université de Bagdad", "Université du Caire"], o_zh: ["大马士革大学", "贝鲁特圣约瑟夫大学", "巴格达大学", "开罗大学"], a: 1 },
                            { q: "5. Quel rôle a joué la France dans les arts et la culture du Proche-Orient ?", q_zh: "5. 法国在近东的艺术和文化中扮演了什么角色？", o: ["Elle a développé une politique de diplomatie culturelle", "Elle a financé des musées uniquement", "Elle a interdit l'usage de la langue arabe", "Elle a introduit la musique moderne"], o_zh: ["它发展了文化外交政策", "它只资助了博物馆", "它禁止使用阿拉伯语", "它引入了现代音乐"], a: 0 },
                        ] },
                     { title: "Vocabulaire", title_zh: "词汇", questions: [
                            { q: "1. Complétez la phrase: La France a joué un rôle important pendant les ______ dans le Proche-Orient.", q_zh: "1. 填空：法国在近东的______期间扮演了重要角色。", o: ["Croisades", "Guerres mondiales", "Révolutions", "Accords commerciaux"], o_zh: ["十字军东征", "世界大战", "革命", "贸易协定"], a: 0, type: 'fill' },
                            { q: "2. Que signifie le mot « protecteur >> dans ce contexte ?", q_zh: "2. 在这种情况下，“保护者”这个词是什么意思？", o: ["Celui qui défend les intérêts", "Celui qui occupe un pays", "Celui qui attaque un autre pays", "Celui qui exporte des produits"], o_zh: ["捍卫利益的人", "占领一个国家的人", "攻击另一个国家的人", "出口产品的人"], a: 0 },
                            { q: "3. Vrai/Faux: Le français est principalement utilisé au Proche-Orient dans les affaires et la culture.", q_zh: "3. 正确/错误：在近东，法语主要用于商业和文化领域。", type: 'tf', a: true },
                            { q: "4. Reliez les expressions avec leur signification:", q_zh: "4. 将表达与其含义连接起来：", type: 'match', items: ["A. Diplomatie", "B. Croisades", "C. Université Saint-Joseph"], items_zh: ["A. 外交", "B. 十字军东征", "C. 圣约瑟夫大学"], matches: ["1) Stratégie pour protéger des intérêts", "2) Conflit pour les lieux saints", "3) Un centre de savoir au Liban"], matches_zh: ["1) 保护利益的策略", "2) 为圣地而发生的冲突", "3) 黎巴嫩的一个知识中心"], a: [0, 1, 2] },
                            { q: "5. Quel mot désigne un accord entre deux pays pour se protéger ?", q_zh: "5. 哪个词指两国为互相保护而达成的协议？", o: ["Alliance", "Traité", "Diplomatie", "Croisade"], o_zh: ["联盟", "条约", "外交", "十字军东征"], a: 0 },
                        ] }
                ]
            },
            { id: "afrique-subsaharienne", title: "11.3 L'AFRIQUE SUBSAHARIENNE", title_zh: "11.3 撒哈拉以南非洲",
                sections: [
                    { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Combien de zones sont identifiées dans l'Afrique subsaharienne ?", q_zh: "1. 在撒哈拉以南非洲确定了多少个区域？", o: ["Deux", "Trois", "Quatre", "Cinq"], o_zh: ["两个", "三个", "四个", "五个"], a: 1 },
                            { q: "2. Quelle est la principale langue utilisée en Afrique subsaharienne ?", q_zh: "2. 撒哈拉以南非洲使用的主要语言是什么？", o: ["L'arabe", "Le français", "L'anglais", "Le swahili"], o_zh: ["阿拉伯语", "法语", "英语", "斯瓦希里语"], a: 1 },
                            { q: "3. Quels sont les pays de l'Afrique subsaharienne mentionnés dans le texte ?", q_zh: "3. 文中提到了哪些撒哈拉以南非洲国家？", o: ["Afrique du Sud, Zambie, Nigeria", "Cameroun, Sénégal, Mali", "Niger, Algérie, Tunisie", "Rwanda, Libye, Tchad"], o_zh: ["南非、赞比亚、尼日利亚", "喀麦隆、塞内加尔、马里", "尼日尔、阿尔及利亚、突尼斯", "卢旺达、利比亚、乍得"], a: 1 },
                            { q: "4. Qu'est-ce qui est mentionné comme étant une caractéristique importante de l'Afrique subsaharienne ?", q_zh: "4. 文中提到撒哈拉以南非洲的一个重要特征是什么？", o: ["Une forte croissance démographique", "Une grande stabilité politique", "Un faible taux de chômage", "Une grande quantité de ressources naturelles"], o_zh: ["强劲的人口增长", "高度的政治稳定", "低失业率", "大量的自然资源"], a: 0 },
                            { q: "5. Quel est le défi majeur de l'Afrique subsaharienne aujourd'hui ?", q_zh: "5. 今天撒哈拉以南非洲面临的主要挑战是什么？", o: ["L'influence coloniale", "La croissance démographique", "La pauvreté", "L'industrialisation"], o_zh: ["殖民影响", "人口增长", "贫困", "工业化"], a: 1 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Quelle est la population estimée de Kinshasa ?", q_zh: "1. 金沙萨的估计人口是多少？", o: ["10 millions d'habitants", "3,6 millions d'habitants", "1,5 million d'habitants", "6 millions d'habitants"], o_zh: ["1000万居民", "360万居民", "150万居民", "600万居民"], a: 0 },
                            { q: "2. Quelle est la cause principale des conflits en Afrique subsaharienne ?", q_zh: "2. 撒哈拉以南非洲冲突的主要原因是什么？", o: ["L'accès aux ressources naturelles", "Les tensions religieuses et ethniques", "La pauvreté", "La pollution"], o_zh: ["对自然资源的获取", "宗教和种族紧张关系", "贫困", "污染"], a: 1 },
                            { q: "3. Vrai/Faux: Les pays d'Afrique subsaharienne sont tous indépendants.", q_zh: "3. 正确/错误：撒哈拉以南非洲的国家都是独立的。", type: 'tf', a: true },
                            { q: "4. Quelle langue est la plus parlée dans les Grands Lacs (République Démocratique du Congo, Rwanda, Burundi)?", q_zh: "4. 在大湖区（刚果民主共和国、卢旺达、布隆迪）最常用的语言是什么？", o: ["Le lingala", "Le français", "Le haoussa", "Le swahili"], o_zh: ["林加拉语", "法语", "豪萨语", "斯瓦希里语"], a: 1 },
                            { q: "5. Que signifie l'expression \"fragilité politique\" ?", q_zh: "5. “政治脆弱性”这个表达是什么意思？", o: ["Un gouvernement stable", "La capacité d'un pays à gérer la croissance économique", "La difficulté d'un pays à maintenir l'ordre et l'unité", "Le nombre élevé de guerres"], o_zh: ["一个稳定的政府", "一个国家管理经济增长的能力", "一个国家维持秩序和统一的困难", "大量的战争"], a: 2 },
                        ] },
                    { title: "Vocabulaire", title_zh: "词汇", questions: [
                             { q: "1. Complétez la phrase: L'Afrique subsaharienne connaît une forte ______ de sa population.", q_zh: "1. 填空：撒哈拉以南非洲的人口正在经历强劲的______。", o: ["Croissance", "Réduction", "Diminution", "Stabilisation"], o_zh: ["增长", "减少", "下降", "稳定"], a: 0, type: 'fill' },
                             { q: "2. Vrai/Faux: Le swahili est une langue de communication dans l'Afrique de l'Ouest.", q_zh: "2. 正确/错误：斯瓦希里语是西非的一种交流语言。", type: 'tf', a: false },
                             { q: "3. Reliez les mots à leur signification :", q_zh: "3. 将词语与其含义连接起来：", type: 'match', items: ["A. SIDA", "B. Croissance", "C. Haoussa"], items_zh: ["A. 艾滋病", "B. 增长", "C. 豪萨语"], matches: ["1) Maladie infectieuse", "2) Augmentation de la population", "3) Langue parlée au Niger"], matches_zh: ["1) 传染病", "2) 人口增加", "3) 在尼日尔使用的语言"], a: [0, 1, 2] },
                             { q: "4. Quel terme désigne une maladie contagieuse qui affecte l'Afrique subsaharienne?", q_zh: "4. 哪个术语指影响撒哈拉以南非洲的一种传染病？", o: ["Le choléra", "Le SIDA", "La tuberculose", "Le cancer"], o_zh: ["霍乱", "艾滋病", "结核病", "癌症"], a: 1 },
                             { q: "5. Quel mot désigne la manière dont un pays organise sa politique et ses institutions?", q_zh: "5. 哪个词指一个国家组织其政治和机构的方式？", o: ["Gouvernement", "Démocratie", "Économie", "Politique"], o_zh: ["政府", "民主", "经济", "政治"], a: 3 },
                        ] }
                ]
            },
            { id: "ocean-indien", title: "11.4 L'OCÉAN INDIEN", title_zh: "11.4 印度洋地区",
                sections: [
                    { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Quelles îles de l'océan Indien sont mentionnées dans le texte ?", q_zh: "1. 文中提到了哪些印度洋岛屿？", o: ["La Réunion, Madagascar, Les Seychelles", "Madagascar, Malte, Les Comores", "Mayotte, La Réunion, La Mauricie", "Les Comores, Maldives, île Maurice"], o_zh: ["留尼汪、马达加斯加、塞舌尔", "马达加斯加、马耳他、科摩罗", "马约特、留尼汪、毛里求斯", "科摩罗、马尔代夫、毛里求斯岛"], a: 0 },
                            { q: "2. Quelle est la caractéristique commune de ces îles ?", q_zh: "2. 这些岛屿的共同特征是什么？", o: ["Elles sont toutes volcaniques", "Elles sont toutes des départements français", "Elles sont toutes indépendantes", "Elles ont un climat désertique"], o_zh: ["它们都是火山岛", "它们都是法国的省", "它们都是独立的", "它们有沙漠气候"], a: 0 },
                            { q: "3. Quel produit est principalement exporté de l'île de La Réunion ?", q_zh: "3. 留尼汪岛主要出口什么产品？", o: ["Vanille et ylang-ylang", "Banane et sucre", "Café et cacao", "Pêche et poisson"], o_zh: ["香草和依兰", "香蕉和糖", "咖啡和可可", "渔业和鱼"], a: 1 },
                            { q: "4. Quelles îles de l'océan Indien ont le statut de département français ?", q_zh: "4. 哪些印度洋岛屿具有法国省的地位？", o: ["Les Seychelles et Madagascar", "La Réunion et Mayotte", "Comores et Mayotte", "Maurice et Réunion"], o_zh: ["塞舌尔和马达加斯加", "留尼汪和马约特", "科摩罗和马约特", "毛里求斯和留尼汪"], a: 1 },
                            { q: "5. Que représente la Polynésie française dans l'imaginaire collectif ?", q_zh: "5. 法属波利尼西亚在集体想象中代表什么？", o: ["Une île de grands volcans", "Des plages de sable fin et des paysages tropicaux", "Un centre économique majeur", "Un désert avec peu de population"], o_zh: ["一个有大火山的岛屿", "细腻的沙滩和热带风光", "一个主要的经济中心", "一个人口稀少的沙漠"], a: 1 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Quelle est la principale activité économique des îles de l'océan Indien ?", q_zh: "1. 印度洋岛屿的主要经济活动是什么？", o: ["Le tourisme", "L'agriculture et l'industrie", "La pêche", "L'extraction de minéraux"], o_zh: ["旅游业", "农业和工业", "渔业", "矿产开采"], a: 0 },
                            { q: "2. Quel est le rôle du kava au Vanuatu ?", q_zh: "2. 卡瓦在瓦努阿图的作用是什么？", o: ["Un produit médicinal utilisé pour soigner les maladies", "Un aliment essentiel pour la population", "Une boisson rituelle utilisée pour la paix et l'amitié", "Un parfum utilisé dans les cérémonies religieuses"], o_zh: ["一种用于治疗疾病的药用产品", "一种对人口至关重要的食物", "一种用于和平与友谊的仪式性饮料", "一种在宗教仪式中使用的香水"], a: 2 },
                            { q: "3. Quelle est la principale culture traditionnelle de la Polynésie française ?", q_zh: "3. 法属波利尼西亚的主要传统文化是什么？", o: ["Le maïs", "La culture ma'ohi", "Le riz", "L'huile de coco"], o_zh: ["玉米", "毛利文化", "大米", "椰子油"], a: 1 },
                            { q: "4. Pourquoi les îles de l'océan Indien sont-elles synonymes de tourisme?", q_zh: "4. 为什么印度洋岛屿是旅游的代名词？", o: ["Elles sont riches en ressources naturelles", "Leur climat et paysages attirent de nombreux touristes", "Elles sont des centres industriels", "Elles sont connues pour leur rôle militaire stratégique"], o_zh: ["它们富含自然资源", "它们的气候和风景吸引了众多游客", "它们是工业中心", "它们以其战略军事作用而闻名"], a: 1 },
                            { q: "5. Quel est l'élément principal qui caractérise le paysage de La Réunion ?", q_zh: "5. 构成留尼汪风景的主要元素是什么？", o: ["Ses montagnes volcaniques", "Ses plages de sable noir", "Ses plaines agricoles", "Ses forêts tropicales denses"], o_zh: ["它的火山山脉", "它的黑沙滩", "它的农业平原", "它的茂密热带雨林"], a: 0 },
                        ] },
                    { title: "Vocabulaire", title_zh: "词汇", questions: [
                            { q: "1. Complétez la phrase: Les îles de l'océan Indien sont principalement connues pour leurs ______ magnifiques.", q_zh: "1. 填空：印度洋岛屿主要以其壮丽的______而闻名。", o: ["Plages", "Déserts", "Montagnes", "Forêts"], o_zh: ["海滩", "沙漠", "山脉", "森林"], a: 0, type: 'fill' },
                            { q: "2. Vrai/Faux: Le kava est utilisé pour ses propriétés médicinales uniquement.", q_zh: "2. 正确/错误：卡瓦仅因其药用特性而被使用。", type: 'tf', a: false },
                            { q: "3. Reliez les termes à leur définition:", q_zh: "3. 将术语与其定义连接起来：", type: 'match', items: ["A. Kava", "B. Séga", "C. Polynésie"], items_zh: ["A. 卡瓦", "B. 塞加舞", "C. 波利尼西亚"], matches: ["1) Une boisson rituelle", "2) Un type de danse", "3) Une île volcanique"], matches_zh: ["1) 一种仪式性饮料", "2) 一种舞蹈", "3) 一个火山岛"], a: [0, 1, 2] },
                            { q: "4. Quel mot décrit un produit que l'on vend ou exporte?", q_zh: "4. 哪个词描述了销售或出口的产品？", o: ["Ressource", "Exportation", "Importation", "Produit agricole"], o_zh: ["资源", "出口", "进口", "农产品"], a: 1 },
                            { q: "5. Vrai/Faux: La Réunion est principalement connue pour son activité agricole.", q_zh: "5. 正确/错误：留尼汪主要以其农业活动而闻名。", type: 'tf', a: true },
                        ] }
                ]
            },
            { id: "antilles-guyane", title: "11.5 LES ANTILLES FRANÇAISES ET LA GUYANE", title_zh: "11.5 法属安的列斯群岛和圭亚那",
                sections: [
                    { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Quels pays composent les Antilles françaises ?", q_zh: "1. 哪些国家组成了法属安的列斯群岛？", o: ["Haïti et la Martinique", "La Guadeloupe, La Martinique, Saint-Martin", "La Réunion et la Martinique", "Guadeloupe, Martinique, Guyane"], o_zh: ["海地和马提尼克", "瓜德罗普、马提尼克、圣马丁", "留尼汪和马提尼克", "瓜德罗普、马提尼克、圭亚那"], a: 1 },
                            { q: "2. Quel produit agricole est le plus important dans l'économie des Antilles françaises ?", q_zh: "2. 在法属安的列斯群岛的经济中，哪种农产品最重要？", o: ["Le riz", "Le sucre de canne", "La banane", "Le café"], o_zh: ["大米", "甘蔗", "香蕉", "咖啡"], a: 2 },
                            { q: "3. Quel est le statut politique de la Guyane ?", q_zh: "3. 圭亚那的政治地位是什么？", o: ["Un territoire autonome", "Un département français d'outre-mer", "Un pays indépendant", "Une région indépendante"], o_zh: ["一个自治领土", "一个法国海外省", "一个独立的国家", "一个独立的地区"], a: 1 },
                            { q: "4. Qu'est-ce qui caractérise particulièrement Haïti ?", q_zh: "4. 海地有什么特别之处？", o: ["Son indépendance depuis 1804", "Son statut de département français", "Sa relation avec la France uniquement", "Sa culture asiatique"], o_zh: ["自1804年以来一直独立", "其法国省的地位", "仅与法国的关系", "其亚洲文化"], a: 0 },
                            { q: "5. Pourquoi la Guyane est-elle importante sur le plan spatial ?", q_zh: "5. 为什么圭亚那在航天领域很重要？", o: ["Parce qu'elle a une base de lancement pour fusées", "Parce qu'elle a une grande réserve de pétrole", "Parce qu'elle est un site archéologique majeur", "Parce qu'elle est la première productrice de café"], o_zh: ["因为它有一个火箭发射基地", "因为它有大量的石油储备", "因为它是一个重要的考古遗址", "因为它是咖啡的第一大生产国"], a: 0 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Quel est l'un des produits agricoles les plus exportés des Antilles françaises ?", q_zh: "1. 法属安的列斯群岛出口最多的农产品之一是什么？", o: ["Le cacao", "La banane", "Le riz", "Le coton"], o_zh: ["可可", "香蕉", "大米", "棉花"], a: 1 },
                            { q: "2. Quelle est la principale activité économique de la Guyane ?", q_zh: "2. 圭亚那的主要经济活动是什么？", o: ["L'agriculture", "Le tourisme", "L'industrie aérospatiale", "La pêche"], o_zh: ["农业", "旅游业", "航空航天工业", "渔业"], a: 2 },
                            { q: "3. Vrai/Faux: Haïti a obtenu son indépendance après une révolte des esclaves.", q_zh: "3. 正确/错误：海地是在奴隶起义后获得独立的。", type: 'tf', a: true },
                            { q: "4. Quelle est la particularité de la Guyane en termes de biodiversité ?", q_zh: "4. 圭亚那在生物多样性方面有什么特点？", o: ["Elle a des déserts", "Elle est recouverte à 98% de forêts tropicales", "Elle est principalement une zone montagneuse", "Elle a peu de diversité végétale"], o_zh: ["它有沙漠", "它98%的面积被热带雨林覆盖", "它主要是一个山区", "它的植物多样性很少"], a: 1 },
                            { q: "5. Quel est le rôle des écrivains haïtiens dans la culture mondiale ?", q_zh: "5. 海地作家在世界文化中的作用是什么？", o: ["Ils sont connus pour leur musique", "Ils ont une grande influence en littérature, comme Dany Laferrière", "Ils sont principalement des cinéastes", "Ils sont surtout des artistes peintres"], o_zh: ["他们以音乐闻名", "他们在文学界有很大影响力，例如丹尼·拉费里埃", "他们主要是电影制作人", "他们主要是画家"], a: 1 },
                        ] },
                    { title: "Vocabulaire", title_zh: "词汇", questions: [
                            { q: "1. Complétez la phrase: Haïti est le premier pays à obtenir son indépendance après ______.", q_zh: "1. 填空：海地是在______之后第一个获得独立的国家。", o: ["Une révolte des esclaves", "L'invasion d'un pays étranger", "Une guerre avec les États-Unis", "Une colonisation européenne"], o_zh: ["一场奴隶起义", "外国入侵", "与美国的战争", "欧洲殖民"], a: 0, type: 'fill' },
                            { q: "2. Vrai/Faux: La Guyane est célèbre pour ses forêts tropicales.", q_zh: "2. 正确/错误：圭亚那以其热带雨林而闻名。", type: 'tf', a: true },
                            { q: "3. Reliez les termes aux bonnes définitions:", q_zh: "3. 将术语与正确的定义连接起来：", type: 'match', items: ["A. Guyane", "B. Haïti", "C. Guadeloupe"], items_zh: ["A. 圭亚那", "B. 海地", "C. 瓜德罗普"], matches: ["1) Base spatiale", "2) Premier pays indépendant des Caraïbes", "3) Département français"], matches_zh: ["1) 航天基地", "2) 加勒比地区第一个独立的国家", "3) 法国的一个省"], a: [0, 1, 2] },
                            { q: "4. Quel mot désigne un espace naturel protégé ?", q_zh: "4. 哪个词指一个受保护的自然区域？", o: ["Réserve", "Forêt", "Jardin", "Lieu touristique"], o_zh: ["保护区", "森林", "花园", "旅游景点"], a: 0 },
                            { q: "5. Complétez la phrase: La Guyane est un département ______ d'outre-mer.", q_zh: "5. 填空：圭亚那是一个______海外省。", o: ["Français", "Autonome", "Indépendant", "Étranger"], o_zh: ["法国", "自治", "独立", "外国"], a: 0, type: 'fill' },
                        ] }
                ]
            },
            { id: "nouvelle-caledonie-polynesie", title: "11.6 DE LA NOUVELLE-CALÉDONIE À LA POLYNÉSIE FRANÇAISE", title_zh: "11.6 从新喀里多尼亚到法属波利尼西亚",
                sections: [
                     { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Quel est le statut politique de la Nouvelle-Calédonie ?", q_zh: "1. 新喀里多尼亚的政治地位是什么？", o: ["Département français d'outre-mer", "Pays indépendant", "Collectivité d'outre-mer avec une large autonomie", "Région autonome de l'Australie"], o_zh: ["法国海外省", "独立国家", "拥有广泛自治权的海外集体", "澳大利亚的自治区"], a: 2 },
                            { q: "2. Quelle est la principale ressource naturelle de la Nouvelle-Calédonie ?", q_zh: "2. 新喀里多尼亚的主要自然资源是什么？", o: ["Nickel", "Diamants", "Pétrole", "Cacao"], o_zh: ["镍", "钻石", "石油", "可可"], a: 0 },
                            { q: "3. Quelles îles sont considérées comme un groupe d'îles perdues entre l'Australie et la Papouasie-Nouvelle-Guinée ?", q_zh: "3. 哪些岛屿被认为是澳大利亚和巴布亚新几内亚之间的一组失落岛屿？", o: ["Les îles Marquises", "La Polynésie française et la Nouvelle-Calédonie", "Les îles des États-Unis", "Les îles Malouines"], o_zh: ["马克萨斯群岛", "法属波利尼西亚和新喀里多尼亚", "美国的岛屿", "马尔维纳斯群岛"], a: 1 },
                            { q: "4. Quel est le produit principal de la Polynésie française ?", q_zh: "4. 法属波利尼西亚的主要产品是什么？", o: ["Perles et vanille", "Riz et sucre", "Café et cacao", "Pêche et pétrole"], o_zh: ["珍珠和香草", "大米和糖", "咖啡和可可", "渔业和石油"], a: 0 },
                            { q: "5. Quelles cultures sont importantes en Nouvelle-Calédonie ?", q_zh: "5. 在新喀里多尼亚，哪些文化是重要的？", o: ["La culture kanake", "La culture ma'ohi", "La culture asiatique", "La culture européenne"], o_zh: ["卡纳克文化", "毛利文化", "亚洲文化", "欧洲文化"], a: 0 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Quelle est la superficie maritime des îles francophones du Pacifique ?", q_zh: "1. 太平洋法语岛屿的海洋面积是多少？", o: ["6,5 millions de km²", "10 millions de km²", "5 millions de km²", "1 million de km²"], o_zh: ["650万平方公里", "1000万平方公里", "500万平方公里", "100万平方公里"], a: 0 },
                            { q: "2. Quel est l'élément culturel majeur de la Nouvelle-Calédonie ?", q_zh: "2. 新喀里多尼亚的主要文化元素是什么？", o: ["La culture kanake, l'architecture et la danse", "L'art chinois et la cuisine", "La peinture et le cinéma", "Le théâtre et la littérature"], o_zh: ["卡纳克文化、建筑和舞蹈", "中国艺术和美食", "绘画和电影", "戏剧和文学"], a: 0 },
                            { q: "3. Vrai/Faux: Le Vanuatu est un État indépendant.", q_zh: "3. 正确/错误：瓦努阿图是一个独立的国家。", type: 'tf', a: true },
                            { q: "4. Quel est le rôle du nickel dans l'économie de la Nouvelle-Calédonie ?", q_zh: "4. 镍在新喀里多尼亚经济中的作用是什么？", o: ["C'est la principale exportation", "Il est utilisé pour produire des aliments", "Il est utilisé uniquement pour les bijoux", "Il est une ressource touristique"], o_zh: ["它是主要出口产品", "它用于生产食品", "它仅用于珠宝", "它是一种旅游资源"], a: 0 },
                            { q: "5. Vrai/Faux: La Polynésie française est connue pour ses grands volcans et ses lagons protégés.", q_zh: "5. 正确/错误：法属波利尼西亚以其大火山和受保护的泻湖而闻名。", type: 'tf', a: true },
                        ] },
                    { title: "Vocabulaire", title_zh: "词汇", questions: [
                            { q: "1. Complétez la phrase: La culture ma'ohi est connue pour ______.", q_zh: "1. 填空：毛利文化以其______而闻名。", o: ["La danse, la sculpture et les tatouages", "Le chant et les peintures", "La pêche et l'agriculture", "La musique traditionnelle"], o_zh: ["舞蹈、雕塑和纹身", "歌唱和绘画", "渔业和农业", "传统音乐"], a: 0, type: 'fill' },
                            { q: "2. Vrai/Faux: Le Vanuatu est une île indépendante du Pacifique.", q_zh: "2. 正确/错误：瓦努阿图是太平洋上的一个独立岛屿。", type: 'tf', a: true },
                            { q: "3. Reliez les termes à leur signification :", q_zh: "3. 将术语与其含义连接起来：", type: 'match', items: ["A. Polynésie", "B. Nouvelle-Calédonie", "C. Nickel"], items_zh: ["A. 波利尼西亚", "B. 新喀里多尼亚", "C. 镍"], matches: ["1) Les îles de la culture ma'ohi", "2) Îles au statut d'autonomie", "3) Ressource importante de la Nouvelle-Calédonie"], matches_zh: ["1) 毛利文化的岛屿", "2) 拥有自治地位的岛屿", "3) 新喀里多尼亚的重要资源"], a: [0, 1, 2] },
                            { q: "4. Quel mot désigne une région éloignée avec une autonomie politique ?", q_zh: "4. 哪个词指一个拥有政治自治权的偏远地区？", o: ["Collectivité", "Département", "Pays indépendant", "Région agricole"], o_zh: ["集体", "省", "独立国家", "农业区"], a: 0 },
                            { q: "5. Complétez la phrase: La Nouvelle-Calédonie est le troisième producteur mondial de ______.", q_zh: "5. 填空：新喀里多尼亚是世界第三大______生产国。", o: ["Nickel", "Café", "Coton", "Riz"], o_zh: ["镍", "咖啡", "棉花", "大米"], a: 0, type: 'fill' },
                        ] }
                ]
            },
            { id: "asie-sud-est", title: "11.7 L'ASIE DU SUD-EST", title_zh: "11.7 东南亚",
                sections: [
                    { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Quels pays composent l'Asie du Sud-Est francophone mentionnés dans le texte ?", q_zh: "1. 文中提到的东南亚法语国家有哪些？", o: ["Vietnam, Cambodge, Laos", "Vietnam, Thaïlande, Chine", "Cambodge, Laos, Malaisie", "Indonésie, Laos, Thaïlande"], o_zh: ["越南、柬埔寨、老挝", "越南、泰国、中国", "柬埔寨、老挝、马来西亚", "印度尼西亚、老挝、泰国"], a: 0 },
                            { q: "2. Quel était le nom de la région pendant la colonisation française ?", q_zh: "2. 在法国殖民时期，该地区的名字是什么？", o: ["Indochine française", "Asie française", "Indochine européenne", "Union indochinoise"], o_zh: ["法属印度支那", "法属亚洲", "欧属印度支那", "印度支那联盟"], a: 0 },
                            { q: "3. Quelle est la principale raison pour laquelle le français est encore parlé en Asie du Sud-Est?", q_zh: "3. 为什么东南亚仍在使用法语的主要原因是什么？", o: ["Les pays sont toujours sous domination française", "Le français est une langue principale dans ces pays", "L'histoire coloniale française et les relations culturelles", "Il est parlé uniquement dans les écoles"], o_zh: ["这些国家仍处于法国统治之下", "法语是这些国家的主要语言", "法国的殖民历史和文化关系", "它只在学校里使用"], a: 2 },
                            { q: "4. Quels sont les écrivains français célèbres associés à l'Indochine ?", q_zh: "4. 哪些著名的法国作家与印度支那有关？", o: ["Pierre Loti, André Malraux, Marguerite Duras", "Victor Hugo, Albert Camus, Simone de Beauvoir", "Jean-Paul Sartre, Claude Monet, Frédéric Chopin", "Gustave Flaubert, Jules Verne, Marcel Proust"], o_zh: ["皮埃尔·洛蒂、安德烈·马尔罗、玛格丽特·杜拉斯", "维克多·雨果、阿尔贝·加缪、西蒙·德·波伏娃", "让-保罗·萨特、克洛德·莫奈、弗雷德里克·肖邦", "古斯塔夫·福楼拜、儒勒·凡尔纳、马塞尔·普鲁斯特"], a: 0 },
                            { q: "5. Quelle influence a eu la France sur l'urbanisme de ces pays ?", q_zh: "5. 法国对这些国家的城市规划有何影响？", o: ["Elle a imposé des lois de la circulation", "Elle a construit des infrastructures modernes comme des ponts et des routes", "Elle a introduit des designs architecturaux européens", "Elle a détruit toutes les anciennes structures"], o_zh: ["它强制实施了交通法规", "它建造了像桥梁和道路这样的现代化基础设施", "它引入了欧洲建筑设计", "它摧毁了所有旧建筑"], a: 1 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Quand l'Indochine française a-t-elle cessé d'exister?", q_zh: "1. 法属印度支那何时不复存在？", o: ["En 1945", "En 1954", "En 1960", "En 1975"], o_zh: ["1945年", "1954年", "1960年", "1975年"], a: 1 },
                            { q: "2. Quel événement historique a marqué la fin de la colonisation française en Asie du Sud-Est ?", q_zh: "2. 哪个历史事件标志着法国在东南亚殖民统治的结束？", o: ["La guerre du Vietnam", "Les accords de Genève", "La bataille de Dien Bien Phu", "La création de l'ONU"], o_zh: ["越南战争", "日内瓦协议", "奠边府战役", "联合国的成立"], a: 2 },
                            { q: "3. Vrai/Faux: Le français est la langue officielle au Vietnam, au Cambodge et au Laos.", q_zh: "3. 正确/错误：法语是越南、柬埔寨和老挝的官方语言。", type: 'tf', a: false },
                            { q: "4. Pourquoi les écrivains comme Pierre Loti et André Malraux sont-ils associés à l'Indochine ?", q_zh: "4. 为什么像皮埃尔·洛蒂和安德烈·马尔罗这样的作家与印度支那有关？", o: ["Parce qu'ils ont vécu et écrit sur leurs expériences en Asie du Sud-Est", "Parce qu'ils étaient des politiciens en Indochine", "Parce qu'ils ont été des résistants contre la France coloniale", "Parce qu'ils ont fondé des écoles de langue française en Asie"], o_zh: ["因为他们曾在东南亚生活并写作了关于他们的经历", "因为他们是印度支那的政治家", "因为他们是反抗法国殖民的抵抗者", "因为他们在亚洲建立了法语学校"], a: 0 },
                            { q: "5. Quelle est la principale fonction de l'École française d'Extrême-Orient, fondée en 1900 ?", q_zh: "5. 成立于1900年的法国远东学院的主要职能是什么？", o: ["Enseigner la langue vietnamienne", "Étudier et préserver les civilisations asiatiques", "Former des militaires pour la colonisation", "Créer des relations commerciales avec l'Asie"], o_zh: ["教授越南语", "研究和保护亚洲文明", "为殖民统治培养军事人员", "与亚洲建立商业关系"], a: 1 },
                        ] },
                    { title: "Vocabulaire", title_zh: "词汇", questions: [
                            { q: "1. Que signifie le terme << protectorat >>> dans ce contexte ?", q_zh: "1. 在这种情况下，“保护国”这个词是什么意思？", o: ["Un territoire sous la protection d'une autre nation", "Un territoire totalement indépendant", "Un territoire dévasté par la guerre", "Un territoire sans gouvernement"], o_zh: ["一个受另一个国家保护的领土", "一个完全独立的领土", "一个被战争摧毁的领土", "一个没有政府的领土"], a: 0 },
                            { q: "2. Vrai/Faux: Le terme \"Indochine\" désigne une région regroupant uniquement le Vietnam.", q_zh: "2. 正确/错误：“印度支那”一词仅指越南地区。", type: 'tf', a: false },
                            { q: "3. Reliez les termes à leur définition:", q_zh: "3. 将术语与其定义连接起来：", type: 'match', items: ["A. Indochine", "B. Pierre Loti", "C. Francophonie"], items_zh: ["A. 印度支那", "B. 皮埃尔·洛蒂", "C. 法语圈"], matches: ["1) Ancienne colonie française", "2) Écrivain ayant écrit sur ses voyages en Asie", "3) La langue française partagée par plusieurs pays"], matches_zh: ["1) 前法国殖民地", "2) 写过关于亚洲旅行的作家", "3) 多个国家共享的法语"], a: [0, 1, 2] },
                            { q: "4. Complétez la phrase: Les écrivains français ont contribué à ______ l'histoire coloniale de l'Indochine.", q_zh: "4. 填空：法国作家为______印度支那的殖民历史做出了贡献。", o: ["Réécrire", "Oublier", "Ignorer", "Renier"], o_zh: ["重写", "忘记", "忽略", "否认"], a: 0, type: 'fill' },
                            { q: "5. Quel terme désigne la période où un pays était sous domination française ?", q_zh: "5. 哪个术语指一个国家处于法国统治下的时期？", o: ["Colonisation", "Décolonisation", "Indépendance", "Révolution"], o_zh: ["殖民化", "非殖民化", "独立", "革命"], a: 0 },
                        ] }
                ]
            },
            { id: "amerique-du-nord", title: "11.8 L'AMÉRIQUE DU NORD", title_zh: "11.8 北美",
                sections: [
                    { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Quels sont les principaux territoires francophones de l'Amérique du Nord mentionnés dans le texte ?", q_zh: "1. 文中提到的北美主要法语区有哪些？", o: ["Québec, Ontario, Louisiane", "Québec, Mexique, Louisiane", "États-Unis, Québec, Ontario", "Ontario, Louisiane, Haïti"], o_zh: ["魁北克、安大略、路易斯安那", "魁北克、墨西哥、路易斯安那", "美国、魁北克、安大略", "安大略、路易斯安那、海地"], a: 0 },
                            { q: "2. Quelle est la situation linguistique au Québec ?", q_zh: "2. 魁北克的语言状况如何？", o: ["Le français est la langue officielle", "L'anglais est la langue officielle", "Le français et l'anglais sont utilisés à parts égales", "Il n'y a pas de langue officielle"], o_zh: ["法语是官方语言", "英语是官方语言", "法语和英语被平等使用", "没有官方语言"], a: 0 },
                            { q: "3. Quel est le rôle de la Loi 101 au Québec ?", q_zh: "3. 魁北克的101法案有什么作用？", o: ["Elle interdit l'utilisation de l'anglais", "Elle protège l'usage du français dans la vie publique", "Elle impose l'anglais dans les écoles", "Elle encourage l'utilisation du français uniquement dans les maisons"], o_zh: ["它禁止使用英语", "它保护法语在公共生活中的使用", "它在学校强制使用英语", "它鼓励只在家里使用法语"], a: 1 },
                            { q: "4. Quelle est la principale région francophone aux États-Unis ?", q_zh: "4. 美国主要的法语区是哪个？", o: ["La Louisiane", "Le Maine", "La Floride", "La Californie"], o_zh: ["路易斯安那州", "缅因州", "佛罗里达州", "加利福尼亚州"], a: 0 },
                            { q: "5. Quel genre musical est lié à la Louisiane et a des racines françaises ?", q_zh: "5. 哪种音乐类型与路易斯安那有关并有法国根源？", o: ["Jazz", "Country", "Blues", "Hip-hop"], o_zh: ["爵士乐", "乡村音乐", "蓝调", "嘻哈"], a: 0 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Quel est le statut linguistique du Nouveau-Brunswick ?", q_zh: "1. 新不伦瑞克省的语言地位是什么？", o: ["Il est officiellement bilingue", "Il utilise uniquement l'anglais", "Il utilise uniquement le français", "Il est une province où l'anglais est plus parlé"], o_zh: ["它是官方双语区", "它只使用英语", "它只使用法语", "它是一个英语使用更多的省份"], a: 0 },
                            { q: "2. Vrai/Faux: Le français est largement parlé au Manitoba.", q_zh: "2. 正确/错误：法语在马尼托巴省被广泛使用。", type: 'tf', a: false },
                            { q: "3. Quelles grandes villes sont mentionnées dans le texte comme étant francophones en Amérique du Nord ?", q_zh: "3. 文中提到了哪些北美法语城市？", o: ["Montréal, Ottawa, Québec, La Nouvelle-Orléans", "Montréal, Toronto, New York", "Montréal, Boston, San Francisco", "Montréal, Chicago, Vancouver"], o_zh: ["蒙特利尔、渥たわ、魁北克市、新奥尔良", "蒙特利尔、多伦多、纽约", "蒙特利尔、波士顿、旧金山", "蒙特利尔、芝加哥、温哥华"], a: 0 },
                            { q: "4. Quel est le rôle du français en Louisiane?", q_zh: "4. 法语在路易斯安那州的作用是什么？", o: ["Il est uniquement parlé dans les écoles", "Il est la langue officielle du gouvernement", "Il est une langue culturelle, parlée par une grande partie de la population", "Il est abandonné au profit de l'anglais"], o_zh: ["它只在学校里说", "它是政府的官方语言", "它是一种文化语言，被大部分人口使用", "它已被英语取代"], a: 2 },
                            { q: "5. Comment le Québec protège-t-il la langue française ?", q_zh: "5. 魁北克如何保护法语？", o: ["En imposant l'anglais dans les écoles", "En créant des lois comme la Loi 101 pour protéger le français", "En excluant l'anglais de l'administration", "En rendant l'anglais obligatoire dans toutes les entreprises"], o_zh: ["通过在学校强制使用英语", "通过制定像101法案这样的法律来保护法语", "通过将英语排除在行政之外", "通过在所有公司强制使用英语"], a: 1 },
                        ] },
                    { title: "Vocabulaire", title_zh: "词汇", questions: [
                            { q: "1. Vrai/Faux: La Loi 101 protège le français dans la vie publique au Québec.", q_zh: "1. 正确/错误：101法案保护了魁北克公共生活中的法语。", type: 'tf', a: true },
                            { q: "2. Complétez la phrase: Le jazz est un genre musical qui a des racines ______.", q_zh: "2. 填空：爵士乐是一种有______根源的音乐类型。", o: ["Françaises", "Africaines", "Européennes", "Américaines"], o_zh: ["法国", "非洲", "欧洲", "美国"], a: 0, type: 'fill' },
                            { q: "3. Reliez les expressions avec leurs significations:", q_zh: "3. 将表达与其含义连接起来：", type: 'match', items: ["A. Loi 101", "B. Louisiane", "C. Québec"], items_zh: ["A. 101法案", "B. 路易斯安那", "C. 魁北克"], matches: ["1) Langue officielle du Québec", "2) Un état américain où le français est parlé", "3) Une province canadienne avec une majorité francophone"], matches_zh: ["1) 魁北克的官方语言", "2) 一个讲法语的美国州", "3) 一个法语人口占多数的加拿大省份"], a: [0, 1, 2] },
                            { q: "4. Quel terme désigne un ensemble de lois pour protéger une langue ?", q_zh: "4. 哪个术语指一套保护语言的法律？", o: ["Charte", "Loi linguistique", "Accord culturel", "Droit international"], o_zh: ["宪章", "语言法", "文化协议", "国际法"], a: 1 },
                            { q: "5. Vrai/Faux: Le français est une langue minoritaire aux États-Unis.", q_zh: "5. 正确/错误：法语在美国是一种少数民族语言。", type: 'tf', a: true },
                        ] }
                ]
            },
            { id: "europe", title: "11.9 L'EUROPE", title_zh: "11.9 欧洲",
                sections: [
                    { title: "Compréhension globale", title_zh: "整体理解", questions: [
                            { q: "1. Quels pays d'Europe sont mentionnés comme étant francophones dans le texte ?", q_zh: "1. 文中提到了哪些欧洲法语国家？", o: ["Belgique, Luxembourg, Suisse", "Belgique, France, Allemagne", "Espagne, Luxembourg, Belgique", "Suisse, Italie, Luxembourg"], o_zh: ["比利时、卢森堡、瑞士", "比利时、法国、德国", "西班牙、卢森堡、比利时", "瑞士、意大利、卢森堡"], a: 0 },
                            { q: "2. Quels sont les principaux endroits où l'on parle français en Suisse ?", q_zh: "2. 在瑞士，主要在哪些地方讲法语？", o: ["Canton de Genève, canton de Vaud, canton de Neuchâtel", "Canton de Zürich, canton de Genève, canton de Valais", "Canton de Fribourg, canton de Neuchâtel", "Canton de Vaud, canton de Thurgovie"], o_zh: ["日内瓦州、沃州、纳沙泰尔州", "苏黎世州、日内瓦州、瓦莱州", "弗里堡州、纳沙泰尔州", "沃州、图尔高州"], a: 0 },
                            { q: "3. Vrai/Faux: Le français est parlé dans la région du Val d'Aoste en Italie.", q_zh: "3. 正确/错误：在意大利的瓦莱达奥斯塔大区讲法语。", type: 'tf', a: true },
                            { q: "4. Quel est le terme pour désigner un pays où plusieurs langues sont parlées ?", q_zh: "4. 用什么术语来指一个讲多种语言的国家？", o: ["Monolingue", "Multilingue", "Homogène", "Unilingue"], o_zh: ["单语的", "多语的", "同质的", "单语的"], a: 1 },
                            { q: "5. Quelles villes sont citées comme ayant une grande influence francophone en Europe ?", q_zh: "5. 哪些城市被认为是欧洲具有重大法语影响力的城市？", o: ["Bruxelles, Genève, Lausanne", "Paris, Lyon, Marseille", "Genève, Paris, Rome", "Bruxelles, Milan, Luxembourg"], o_zh: ["布鲁塞尔、日内瓦、洛桑", "巴黎、里昂、马赛", "日内瓦、巴黎、罗马", "布鲁塞尔、米兰、卢森堡"], a: 0 },
                        ] },
                    { title: "Compréhension détaillée", title_zh: "细节理解", questions: [
                            { q: "1. Quel produit est principalement exporté de la Belgique et de la Suisse ?", q_zh: "1. 比利时和瑞士主要出口什么产品？", o: ["Chocolat et fromage", "Pétrole et gaz", "Nickel et or", "Automobiles et machines"], o_zh: ["巧克力和奶酪", "石油和天然气", "镍和黄金", "汽车和机械"], a: 0 },
                            { q: "2. Quel est le rôle de Bruxelles dans l'Union européenne ?", q_zh: "2. 布鲁塞尔在欧盟中的作用是什么？", o: ["Ville siège des Nations Unies", "Siège des institutions européennes", "Centre de production industrielle", "Ville touristique importante"], o_zh: ["联合国总部城市", "欧洲机构所在地", "工业生产中心", "重要的旅游城市"], a: 1 },
                            { q: "3. Vrai/Faux: La Belgique est le seul pays où le français est parlé dans toutes ses régions.", q_zh: "3. 正确/错误：比利时是唯一一个所有地区都讲法语的国家。", type: 'tf', a: false },
                            { q: "4. Quel est le statut du français dans la Suisse ?", q_zh: "4. 法语在瑞士的地位是什么？", o: ["Langue officielle dans tous les cantons", "Langue officielle uniquement à Genève", "Langue régionale", "Langue étrangère obligatoire dans les écoles"], o_zh: ["所有州的官方语言", "仅在日内瓦是官方语言", "地区性语言", "学校强制学习的外语"], a: 2 },
                            { q: "5. Qu'est-ce qui distingue le français de Belgique, Suisse et Luxembourg de celui de France ?", q_zh: "5. 比利时、瑞士和卢森堡的法语与法国的法语有何不同？", o: ["L'utilisation de certains mots et expressions spécifiques", "Le français est parlé plus vite", "La grammaire est différente", "Le français de ces pays n'a pas de vocabulaire moderne"], o_zh: ["使用一些特定的词汇和表达方式", "这些国家的法语说得更快", "语法不同", "这些国家的法语没有现代词汇"], a: 0 },
                        ] },
                    { title: "Vocabulaire", title_zh: "词汇", questions: [
                            { q: "1. Complétez la phrase: La Belgique est un pays ______ avec des communautés qui parlent différentes langues.", q_zh: "1. 填空：比利时是一个______国家，其社区使用不同的语言。", o: ["Multilingue", "Unilingue", "Monolingue", "Européen"], o_zh: ["多语的", "单语的", "单语的", "欧洲的"], a: 0, type: 'fill' },
                            { q: "2. Vrai/Faux: Le français de Belgique utilise des mots différents de ceux de la France.", q_zh: "2. 正确/错误：比利时法语使用的词汇与法国法语不同。", type: 'tf', a: true },
                            { q: "3. Reliez les expressions avec leur signification:", q_zh: "3. 将表达与其含义连接起来：", type: 'match', items: ["A. Val d'Aoste", "B. Bruxelles", "C. Suisse"], items_zh: ["A. 瓦莱达奥斯塔", "B. 布鲁塞尔", "C. 瑞士"], matches: ["1) Région italienne où l'on parle français", "2) Ville avec des institutions européennes", "3) Pays multilingue où le français est parlé"], matches_zh: ["1) 意大利一个讲法语的地区", "2) 拥有欧洲机构的城市", "3) 一个讲法语的多语国家"], a: [0, 1, 2] },
                            { q: "4. Quel mot désigne l'utilisation de plusieurs langues dans un pays ?", q_zh: "4. 哪个词指一个国家使用多种语言？", o: ["Multilinguisme", "Monolinguisme", "Monoculturalisme", "Bilinguisme"], o_zh: ["多语制", "单语制", "单文化主义", "双语制"], a: 0 },
                            { q: "5. Complétez la phrase: Le Luxembourg a une population de ______ personnes.", q_zh: "5. 填空：卢森堡的人口为______人。", o: ["450,000", "1,2 million", "2 millions", "10 millions"], o_zh: ["45万", "120万", "200万", "1000万"], a: 0, type: 'fill' },
                        ] }
                ]
            }
        ];

        const quizContainer = document.getElementById('quiz-container');
        const navigation = document.getElementById('navigation');
        const checkBtn = document.getElementById('check-answers-btn');
        const resetBtn = document.getElementById('reset-btn');
        const mobileScoreContainer = document.getElementById('mobile-score-container');
        const desktopScoreContainer = document.getElementById('desktop-score-container');
        const showAnswersBtn = document.getElementById('show-answers-btn');
        const confirmationModal = document.getElementById('confirmation-modal');
        const modalCancelBtn = document.getElementById('modal-cancel-btn');
        const modalConfirmBtn = document.getElementById('modal-confirm-btn');
        const langSwitchBtn = document.getElementById('lang-switch-btn');
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        const sunIcon = document.getElementById('theme-icon-sun');
        const moonIcon = document.getElementById('theme-icon-moon');
        const themeBtnText = document.getElementById('theme-btn-text');


        let totalQuestions = 0;
        let currentLang = 'fr'; // 'fr' or 'zh'

        // 保存答案
        function saveAnswers() {
            const answers = {};
            const allQuestions = document.querySelectorAll('[data-question]');
            allQuestions.forEach(qEl => {
                const regionIndex = qEl.dataset.region;
                const sectionIndex = qEl.dataset.section;
                const qIndex = qEl.dataset.question;
                const questionData = quizData[regionIndex].sections[sectionIndex].questions[qIndex];
                const type = questionData.type || 'mcq';
                const id = `q-${regionIndex}-${sectionIndex}-${qIndex}`;

                if (type === 'match') {
                    const input = qEl.querySelector('input[type="text"]');
                    if (input) answers[id] = input.value;
                } else {
                    const selectedRadio = qEl.querySelector('input[type="radio"]:checked');
                    if (selectedRadio) answers[id] = selectedRadio.value;
                }
            });
            return answers;
        }

        // 恢复答案
        function restoreAnswers(answers) {
            for (const id in answers) {
                const parts = id.split('-');
                const regionIndex = parts[1];
                const sectionIndex = parts[2];
                const qIndex = parts[3];
                const qEl = document.querySelector(`[data-region='${regionIndex}'][data-section='${sectionIndex}'][data-question='${qIndex}']`);
                if (qEl) {
                    const questionData = quizData[regionIndex].sections[sectionIndex].questions[qIndex];
                    const type = questionData.type || 'mcq';
                    if (type === 'match') {
                        const input = qEl.querySelector('input[type="text"]');
                        if (input) input.value = answers[id];
                    } else {
                        const radioToSelect = qEl.querySelector(`input[value="${answers[id]}"]`);
                        if (radioToSelect) radioToSelect.checked = true;
                    }
                }
            }
        }

        // 渲染整个问卷
        function renderQuiz(lang) {
            const answers = saveAnswers();
            quizContainer.innerHTML = '';
            navigation.innerHTML = '';
            totalQuestions = 0;

            quizData.forEach((region, regionIndex) => {
                const navLink = document.createElement('a');
                navLink.href = `#${region.id}`;
                navLink.dataset.navId = region.id;
                navLink.textContent = lang === 'fr' ? region.title : region.title_zh;
                navLink.className = 'block px-4 py-2 text-secondary rounded-md hover:bg-accent hover:text-brand-primary transitionable';
                navLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById(region.id)?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    // Close sidebar on mobile after clicking a link
                    if (window.innerWidth < 768) {
                        toggleSidebar(false);
                    }
                });
                navigation.appendChild(navLink);

                const regionEl = document.createElement('div');
                regionEl.id = region.id;
                regionEl.className = 'mb-12 scroll-mt-20'; // Increased scroll margin top for mobile header
                
                const regionTitle = document.createElement('h2');
                regionTitle.textContent = lang === 'fr' ? `${region.title} (${region.title_zh})` : `${region.title_zh} (${region.title})`;
                regionTitle.className = 'text-3xl font-bold text-primary mb-8 border-b-2 border-brand-secondary pb-2 transitionable';
                regionEl.appendChild(regionTitle);

                region.sections.forEach((section, sectionIndex) => {
                    const sectionEl = document.createElement('div');
                    sectionEl.className = 'mb-8 p-6 bg-secondary rounded-xl shadow-md border border-primary transitionable';
                    
                    const sectionTitle = document.createElement('h3');
                    sectionTitle.textContent = lang === 'fr' ? section.title : section.title_zh;
                    sectionTitle.className = 'text-xl font-semibold text-primary mb-6 transitionable';
                    sectionEl.appendChild(sectionTitle);

                    section.questions.forEach((q, qIndex) => {
                        totalQuestions++;
                        const qEl = document.createElement('div');
                        qEl.className = 'mb-6 pb-4 border-b border-secondary last:border-b-0 last:pb-0 transitionable';
                        qEl.dataset.region = regionIndex;
                        qEl.dataset.section = sectionIndex;
                        qEl.dataset.question = qIndex;

                        const questionText = document.createElement('p');
                        questionText.className = 'font-medium mb-3 text-primary transitionable';
                        questionText.textContent = lang === 'fr' ? q.q : q.q_zh;
                        qEl.appendChild(questionText);
                        
                        const answerContainer = document.createElement('div');
                        answerContainer.className = 'space-y-2';
                        const type = q.type || 'mcq';

                        switch(type) {
                            case 'mcq':
                            case 'fill':
                                const optionsMCQ = lang === 'fr' ? q.o : q.o_zh;
                                optionsMCQ.forEach((option, optionIndex) => {
                                    const label = document.createElement('label');
                                    label.className = 'flex items-center p-3 rounded-lg border border-primary hover:bg-tertiary cursor-pointer transitionable';
                                    const radio = document.createElement('input');
                                    radio.type = 'radio';
                                    radio.name = `q-${regionIndex}-${sectionIndex}-${qIndex}`;
                                    radio.value = optionIndex;
                                    radio.className = 'mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:focus:ring-blue-600 dark:ring-offset-gray-800';
                                    label.appendChild(radio);
                                    label.append(option);
                                    answerContainer.appendChild(label);
                                });
                                break;
                            case 'tf':
                                const optionsTF = lang === 'fr' ? ['Vrai', 'Faux'] : ['正确', '错误'];
                                optionsTF.forEach((option, optionIndex) => {
                                    const label = document.createElement('label');
                                    label.className = 'flex items-center p-3 rounded-lg border border-primary hover:bg-tertiary cursor-pointer transitionable';
                                    const radio = document.createElement('input');
                                    radio.type = 'radio';
                                    radio.name = `q-${regionIndex}-${sectionIndex}-${qIndex}`;
                                    radio.value = optionIndex === 0;
                                    radio.className = 'mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:focus:ring-blue-600 dark:ring-offset-gray-800';
                                    label.appendChild(radio);
                                    label.append(option);
                                    answerContainer.appendChild(label);
                                });
                                break;
                            case 'match':
                                const matchContainer = document.createElement('div');
                                matchContainer.className = 'grid grid-cols-1 md:grid-cols-2 gap-4';
                                const itemsCol = document.createElement('div');
                                itemsCol.className = 'space-y-2';
                                const matchesCol = document.createElement('div');
                                matchesCol.className = 'space-y-2';
                                
                                const items = lang === 'fr' ? q.items : (q.items_zh || q.items);
                                items.forEach((item) => {
                                    const itemEl = document.createElement('div');
                                    itemEl.className = 'p-3 bg-tertiary rounded-md transitionable';
                                    itemEl.textContent = item;
                                    itemsCol.appendChild(itemEl);
                                });

                                const matches = lang === 'fr' ? q.matches : (q.matches_zh || q.matches);
                                matches.forEach((match) => {
                                    const matchEl = document.createElement('div');
                                    matchEl.className = 'p-3 bg-accent rounded-md transitionable';
                                    matchEl.textContent = match;
                                    matchesCol.appendChild(matchEl);
                                });

                                const input = document.createElement('input');
                                input.type = 'text';
                                input.placeholder = lang === 'fr' ? 'Ex: A-2, B-1, C-3' : '例如: A-2, B-1, C-3';
                                input.className = 'mt-4 w-full p-2 border border-primary rounded-md focus:ring-blue-500 focus:border-blue-500 bg-primary transitionable';
                                answerContainer.appendChild(matchContainer);
                                matchContainer.appendChild(itemsCol);
                                matchContainer.appendChild(matchesCol);
                                answerContainer.appendChild(input);
                                break;
                        }
                        
                        qEl.appendChild(answerContainer);
                        const feedbackEl = document.createElement('div');
                        feedbackEl.className = 'mt-2 text-sm font-semibold';
                        qEl.appendChild(feedbackEl);
                        sectionEl.appendChild(qEl);
                    });
                    regionEl.appendChild(sectionEl);
                });
                quizContainer.appendChild(regionEl);
            });
            restoreAnswers(answers);
            setupScrollSpy();
        }

        // 更新分数显示
        function updateScoreDisplay(score, total) {
            const scoreText = currentLang === 'fr' ? 'Votre score' : '你的得分';
            const html = `${scoreText}: <span class="text-brand-primary font-bold text-lg">${score}</span> / ${total}`;
            mobileScoreContainer.innerHTML = html;
            desktopScoreContainer.innerHTML = html;
        }

        function resetScoreDisplay() {
            mobileScoreContainer.innerHTML = '';
            desktopScoreContainer.innerHTML = '';
        }


        // 检查答案
        function checkAnswers() {
            let score = 0;
            const allQuestions = document.querySelectorAll('[data-question]');

            allQuestions.forEach(qEl => {
                const regionIndex = qEl.dataset.region;
                const sectionIndex = qEl.dataset.section;
                const qIndex = qEl.dataset.question;
                const questionData = quizData[regionIndex].sections[sectionIndex].questions[qIndex];
                const feedbackEl = qEl.querySelector('.mt-2');
                const type = questionData.type || 'mcq';
                let isCorrect = false;

                qEl.querySelectorAll('label').forEach(l => l.classList.remove('correct-bg', 'incorrect-bg', 'border-green-500', 'border-red-500'));
                if(feedbackEl) feedbackEl.innerHTML = '';

                let correctText = currentLang === 'fr' ? 'Réponse correcte' : '正确答案';

                switch(type) {
                    case 'mcq':
                    case 'fill':
                        const selectedRadioMCQ = qEl.querySelector('input[type="radio"]:checked');
                        if (selectedRadioMCQ) {
                            const userAnswer = parseInt(selectedRadioMCQ.value);
                            isCorrect = userAnswer === questionData.a;
                            const selectedLabel = selectedRadioMCQ.parentElement;
                            if (isCorrect) {
                                selectedLabel.classList.add('correct-bg', 'border-green-500');
                            } else {
                                selectedLabel.classList.add('incorrect-bg', 'border-red-500');
                                const correctLabel = qEl.querySelectorAll('label')[questionData.a];
                                correctLabel.classList.add('correct-bg', 'border-green-500');
                                const correctAnswerText = currentLang === 'fr' ? questionData.o[questionData.a] : questionData.o_zh[questionData.a];
                                feedbackEl.innerHTML = `<span class="correct-answer">${correctText}: ${correctAnswerText}</span>`;
                            }
                        }
                        break;
                    case 'tf':
                        const selectedRadioTF = qEl.querySelector('input[type="radio"]:checked');
                        if (selectedRadioTF) {
                            const userAnswer = selectedRadioTF.value === 'true';
                            isCorrect = userAnswer === questionData.a;
                            const selectedLabel = selectedRadioTF.parentElement;
                            if (isCorrect) {
                                selectedLabel.classList.add('correct-bg', 'border-green-500');
                            } else {
                                selectedLabel.classList.add('incorrect-bg', 'border-red-500');
                                const correctLabel = questionData.a ? qEl.querySelectorAll('label')[0] : qEl.querySelectorAll('label')[1];
                                correctLabel.classList.add('correct-bg', 'border-green-500');
                                const correctAnswerText = currentLang === 'fr' ? (questionData.a ? 'Vrai' : 'Faux') : (questionData.a ? '正确' : '错误');
                                feedbackEl.innerHTML = `<span class="correct-answer">${correctText}: ${correctAnswerText}</span>`;
                            }
                        }
                        break;
                    case 'match':
                        const input = qEl.querySelector('input[type="text"]');
                        if (input) {
                            const correctAnswerText = questionData.a.map((val, index) => `${String.fromCharCode(65 + index)}-${val + 1}`).join(',');
                            if (input.value) {
                                const userAnswer = input.value.replace(/[\s.]/g, '').toUpperCase();
                                isCorrect = userAnswer.split(',').sort().join(',') === correctAnswerText.split(',').sort().join(',');
                                if (isCorrect) {
                                    input.classList.add('correct-bg', 'border-green-500');
                                    input.classList.remove('incorrect-bg', 'border-red-500');
                                } else {
                                    input.classList.add('incorrect-bg', 'border-red-500');
                                    input.classList.remove('correct-bg', 'border-green-500');
                                    feedbackEl.innerHTML = `<span class="correct-answer">${correctText}: ${correctAnswerText.replace(/,/g, ', ')}</span>`;
                                }
                            } else {
                                feedbackEl.innerHTML = `<span class="correct-answer">${correctText}: ${correctAnswerText.replace(/,/g, ', ')}</span>`;
                            }
                        }
                        break;
                }

                if (isCorrect) {
                    score++;
                }
            });

            updateScoreDisplay(score, totalQuestions);
        }
        
        // 重置
        function resetQuiz() {
            const allInputs = document.querySelectorAll('input[type="radio"], input[type="text"]');
            allInputs.forEach(input => {
                if(input.type === 'radio') input.checked = false;
                if(input.type === 'text') input.value = '';
                input.classList.remove('correct-bg', 'border-green-500', 'incorrect-bg', 'border-red-500');
            });

            document.querySelectorAll('label').forEach(l => l.classList.remove('correct-bg', 'incorrect-bg', 'border-green-500', 'border-red-500'));
            
            document.querySelectorAll('.mt-2').forEach(feedback => feedback.innerHTML = '');

            resetScoreDisplay();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 显示答案
        function showAllAnswers() {
            resetQuiz(); 
            
            quizData.forEach((region, regionIndex) => {
                region.sections.forEach((section, sectionIndex) => {
                    section.questions.forEach((q, qIndex) => {
                        const qEl = document.querySelector(`[data-region='${regionIndex}'][data-section='${sectionIndex}'][data-question='${qIndex}']`);
                        const type = q.type || 'mcq';

                        switch(type) {
                            case 'mcq':
                            case 'fill':
                                const correctRadioMCQ = qEl.querySelectorAll('input[type="radio"]')[q.a];
                                if (correctRadioMCQ) correctRadioMCQ.checked = true;
                                break;
                            case 'tf':
                                const correctRadioTF = q.a ? qEl.querySelector('input[value="true"]') : qEl.querySelector('input[value="false"]');
                                if (correctRadioTF) correctRadioTF.checked = true;
                                break;
                            case 'match':
                                const input = qEl.querySelector('input[type="text"]');
                                const correctAnswerText = q.a.map((val, index) => `${String.fromCharCode(65 + index)}-${val + 1}`).join(', ');
                                if (input) input.value = correctAnswerText;
                                break;
                        }
                    });
                });
            });

            checkAnswers();
        }

        // 更新UI文本
        function updateUIText(lang) {
            document.getElementById('main-title').textContent = lang === 'fr' ? 'Exercices sur la Francophonie' : '法语区练习';
            document.getElementById('mobile-title').textContent = lang === 'fr' ? 'Exercices sur la Francophonie' : '法语区练习';
            resetScoreDisplay();
            document.getElementById('show-answers-btn').textContent = lang === 'fr' ? 'Montrer les réponses' : '显示答案';
            document.getElementById('reset-btn').textContent = lang === 'fr' ? 'Réinitialiser' : '重置';
            document.getElementById('check-answers-btn').textContent = lang === 'fr' ? 'Vérifier les réponses' : '检查答案';
            document.getElementById('modal-title').textContent = lang === 'fr' ? 'Confirmer l\'action' : '确认操作';
            document.getElementById('modal-message').textContent = lang === 'fr' ? 'Êtes-vous sûr de vouloir afficher toutes les réponses ? Vos réponses actuelles seront effacées.' : '确定要显示所有答案吗？您当前的作答记录将被清空。';
            document.getElementById('modal-cancel-btn').textContent = lang === 'fr' ? 'Annuler' : '取消';
            document.getElementById('modal-confirm-btn').textContent = lang === 'fr' ? 'Confirmer' : '确定';
            document.getElementById('disclaimer-text').textContent = lang === 'fr' ? 'Avis de non-responsabilité : Les réponses sont générées par l\'IA et sont fournies à titre de référence uniquement.' : '免责声明：答案由AI生成，仅供参考。';
            document.getElementById('copyright-text').textContent = lang === 'fr' ? '© 2025 Hugo. Tous droits réservés.' : '© 2025 Hugo 版权所有。';
            
            const isDark = document.documentElement.classList.contains('dark');
            if (lang === 'fr') {
                themeBtnText.textContent = isDark ? 'Mode Clair' : 'Mode Sombre';
            } else {
                themeBtnText.textContent = isDark ? '浅色模式' : '深色模式';
            }
        }

        // --- 主题切换逻辑 ---
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            } else {
                document.documentElement.classList.remove('dark');
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            }
            updateUIText(currentLang);
        }

        themeToggleBtn.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            const newTheme = isDark ? 'dark' : 'light';
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        });

        // 切换语言
        langSwitchBtn.addEventListener('click', () => {
            currentLang = currentLang === 'fr' ? 'zh' : 'fr';
            renderQuiz(currentLang);
            updateUIText(currentLang);
        });

        // Modal logic
        showAnswersBtn.addEventListener('click', () => {
            confirmationModal.classList.remove('hidden');
            confirmationModal.classList.add('flex');
        });

        modalCancelBtn.addEventListener('click', () => {
            confirmationModal.classList.add('hidden');
            confirmationModal.classList.remove('flex');
        });

        modalConfirmBtn.addEventListener('click', () => {
            showAllAnswers();
            confirmationModal.classList.add('hidden');
            confirmationModal.classList.remove('flex');
        });

        checkBtn.addEventListener('click', checkAnswers);
        resetBtn.addEventListener('click', resetQuiz);
        
        // --- 移动端侧边栏逻辑 ---
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const menuToggleBtn = document.getElementById('menu-toggle-btn');
        
        function toggleSidebar(show) {
            if (show) {
                sidebar.classList.remove('-translate-x-full');
                sidebarOverlay.classList.remove('hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                sidebarOverlay.classList.add('hidden');
            }
        }

        menuToggleBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            toggleSidebar(true);
        });
        sidebarOverlay.addEventListener('click', () => toggleSidebar(false));
        
        // --- 导航栏滚动监听 ---
        let observer;
        function setupScrollSpy() {
            const sections = quizData.map(q => document.getElementById(q.id));
            const navLinks = document.querySelectorAll('[data-nav-id]');

            const observerOptions = {
                root: null,
                rootMargin: "-30% 0px -70% 0px",
                threshold: 0
            };

            observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const navLink = document.querySelector(`[data-nav-id="${entry.target.id}"]`);
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => link.classList.remove('nav-active'));
                        if (navLink) {
                            navLink.classList.add('nav-active');
                        }
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                if (section) observer.observe(section);
            });
        }


        // 初始化
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (savedTheme) {
            applyTheme(savedTheme);
        } else {
            applyTheme(prefersDark ? 'dark' : 'light');
        }
        renderQuiz(currentLang);
        updateUIText(currentLang);

    </script>
</body>
</html>
