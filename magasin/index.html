<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-key="page_title">Ê≥ïÂºèË¥≠Áâ©ÊåáÂçó - Shopping in France</title>
    
    <!-- ÂºïÂÖ• Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ÂºïÂÖ• Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- ÂºïÂÖ• Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Noto+Sans+SC:wght@400;700;900&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            /* --- Neo-Brutalism Palette --- */
            --bg-color: #ffffff;
            --text-main: #000000;
            
            /* Ê†∏ÂøÉËâ≤ */
            --c-yellow: #FFE66D;
            --c-pink: #FF6B6B;
            --c-cyan: #4ECDC4;
            --c-purple: #9b5de5;
            --c-green: #00f5d4;

            --border-width: 3px;
            --shadow-hard: 8px 8px 0px #000000;
            --shadow-hover: 4px 4px 0px #000000;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: 100px;
        }

        body {
            font-family: 'Space Grotesk', 'Noto Sans SC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            overflow-x: hidden;
            /* ÁÇπÈòµËÉåÊôØ */
            background-image: radial-gradient(#000 2px, transparent 2px);
            background-size: 40px 40px;
        }

        :lang(ar) body { font-family: 'Cairo', sans-serif; }

        /* --- Âá†‰ΩïË£ÖÈ•∞ --- */
        .geo-shape {
            position: absolute;
            border: var(--border-width) solid black;
            z-index: -1;
            animation: float 6s ease-in-out infinite;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.1);
        }
        
        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-10px, -15px) rotate(5deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        /* --- Ë∑ëÈ©¨ÁÅØ --- */
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
            background: #000;
            color: #fff;
            border-top: var(--border-width) solid black;
            border-bottom: var(--border-width) solid black;
            transform: rotate(-1deg);
            width: 105%;
            margin-left: -2.5%;
            margin-bottom: 4rem;
            position: relative;
            z-index: 10;
        }
        .marquee-content {
            display: inline-block;
            animation: marquee 30s linear infinite;
            padding: 12px 0;
            font-weight: 900;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* --- ÁªÑ‰ª∂Ê†∑Âºè --- */
        .neo-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: var(--border-width) solid black;
            background: white;
            box-shadow: 4px 4px 0px black;
            font-weight: 700;
            transition: all 0.15s;
            cursor: pointer;
        }
        .neo-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px black;
        }
        .neo-btn:active {
            transform: translate(4px, 4px);
            box-shadow: 0px 0px 0px black;
        }
        .neo-btn.active {
            background: black;
            color: white;
        }

        .neo-card {
            background: white;
            border: var(--border-width) solid black;
            box-shadow: var(--shadow-hard);
            transition: all 0.2s;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
        }
        .neo-card:hover {
            transform: translate(4px, 4px);
            box-shadow: var(--shadow-hover);
        }

        /* ÂïÜÂ∫óÊù°ÁõÆÊ†∑Âºè */
        .shop-item {
            border-bottom: 2px dashed #e5e7eb;
            padding: 0.75rem 0;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            transition: background 0.2s;
        }
        .shop-item:last-child { border-bottom: none; }
        .shop-item:hover { background: #f9fafb; padding-left: 0.5rem; padding-right: 0.5rem; }

        /* ÂØπËØùÊ∞îÊ≥° */
        .bubble {
            background: white;
            border: 2px solid black;
            padding: 1rem;
            position: relative;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.1);
            margin-bottom: 1rem;
        }
        .bubble::after {
            content: '';
            position: absolute;
            border-style: solid;
            border-width: 10px 10px 0;
            border-color: black transparent transparent transparent;
            bottom: -10px;
            left: 20px;
        }
        .bubble.alt {
            background: var(--c-cyan);
        }
        .bubble.alt::after {
            left: auto;
            right: 20px;
            border-color: black transparent transparent transparent;
        }

        /* Ê†áÈ¢òÊ†áÁ≠æ */
        .section-tag {
            display: inline-block;
            background: black;
            color: white;
            padding: 0.5rem 1.5rem;
            font-weight: 900;
            transform: skew(-10deg);
            margin-bottom: 1rem;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: var(--border-width) solid black;
            backdrop-filter: blur(5px);
        }

        /* Back to Top */
        #back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--c-cyan);
            color: black;
            border: 3px solid black;
            padding: 0.8rem;
            box-shadow: 4px 4px 0px black;
            z-index: 50;
            display: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        #back-to-top:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px black;
            background: var(--c-pink);
            color: white;
        }
        
        /* Animation Defaults */
        .animate-on-scroll {
            opacity: 1; /* Ensure visible by default for robustness */
            transition: opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .scroll-hidden {
            opacity: 0;
            transform: translateY(40px);
        }
        
        /* Tooltip/Note Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background: white;
            border: 4px solid black;
            box-shadow: 10px 10px 0px black;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

    </style>
</head>
<body class="min-h-screen flex flex-col relative selection:bg-[var(--c-yellow)] selection:text-black">

    <!-- 1. Âá†‰ΩïËÉåÊôØË£ÖÈ•∞ -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
        <!-- ÈªÑËâ≤ÂúÜ -->
        <div class="geo-shape w-48 h-48 rounded-full bg-[var(--c-yellow)] top-20 left-10 opacity-50"></div>
        <!-- Á≤âËâ≤ÊñπÂùó -->
        <div class="geo-shape w-32 h-32 bg-[var(--c-pink)] top-1/3 right-10 rotate-12 opacity-50"></div>
        <!-- ËìùËâ≤‰∏âËßí -->
        <svg class="geo-shape w-40 h-40 text-[var(--c-cyan)] bottom-20 left-20 opacity-50" viewBox="0 0 100 100">
             <polygon points="50,10 90,90 10,90" fill="currentColor" stroke="black" stroke-width="3"/>
        </svg>
    </div>

    <!-- 2. ÂØºËà™Ê†è -->
    <header class="sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="flex items-center gap-2 group">
                <div class="w-10 h-10 bg-black text-white flex items-center justify-center border-2 border-black group-hover:bg-[var(--c-yellow)] group-hover:text-black transition-colors shadow-[2px_2px_0_0_#000]">
                    <i class="ph-bold ph-shopping-bag text-2xl"></i>
                </div>
                <span class="text-xl font-black uppercase tracking-tighter" data-key="page_title">Ë¥≠Áâ©ÊåáÂçó</span>
            </a>
            
            <!-- Desktop Menu -->
            <div class="hidden md:flex items-center gap-6 font-bold text-sm">
                <a href="#shops" class="hover:bg-[var(--c-yellow)] px-2 py-1 border-2 border-transparent hover:border-black transition-all" data-key="tab_shops">ÂïÜÂ∫óÁ±ªÂûã</a>
                <a href="#templates" class="hover:bg-[var(--c-pink)] px-2 py-1 border-2 border-transparent hover:border-black transition-all" data-key="tab_templates">ÂÆûÁî®ÂØπËØù</a>
                <a href="#quiz" class="hover:bg-[var(--c-cyan)] px-2 py-1 border-2 border-transparent hover:border-black transition-all" data-key="tab_quiz">ËØçÊ±áÊµãÈ™å</a>
                
                <!-- Language Switcher -->
                <div class="flex border-2 border-black bg-white shadow-[2px_2px_0_0_#000]">
                    <button class="lang-btn px-3 py-1 text-xs font-bold hover:bg-black hover:text-white transition-colors border-r-2 border-black active" data-lang="zh">‰∏≠</button>
                    <button class="lang-btn px-3 py-1 text-xs font-bold hover:bg-black hover:text-white transition-colors border-r-2 border-black" data-lang="en">EN</button>
                    <button class="lang-btn px-3 py-1 text-xs font-bold hover:bg-black hover:text-white transition-colors" data-lang="es">ES</button>
                </div>
            </div>

            <!-- Mobile Menu Button -->
            <button id="menu-btn" class="md:hidden p-2 border-2 border-black bg-white shadow-[2px_2px_0_0_#000]">
                <i class="ph-bold ph-list text-xl"></i>
            </button>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-b-[3px] border-black p-6 absolute w-full z-40 shadow-xl flex flex-col gap-4 font-bold">
            <a href="#shops" class="block p-2 hover:bg-[var(--c-yellow)] border-2 border-transparent hover:border-black" data-key="tab_shops">ÂïÜÂ∫óÁ±ªÂûã</a>
            <a href="#templates" class="block p-2 hover:bg-[var(--c-pink)] border-2 border-transparent hover:border-black" data-key="tab_templates">ÂÆûÁî®ÂØπËØù</a>
            <a href="#quiz" class="block p-2 hover:bg-[var(--c-cyan)] border-2 border-transparent hover:border-black" data-key="tab_quiz">ËØçÊ±áÊµãÈ™å</a>
            <div class="flex gap-2 pt-4 border-t-2 border-black">
                <button class="lang-btn flex-1 py-2 border-2 border-black hover:bg-black hover:text-white font-bold text-xs" data-lang="zh">‰∏≠Êñá</button>
                <button class="lang-btn flex-1 py-2 border-2 border-black hover:bg-black hover:text-white font-bold text-xs" data-lang="en">EN</button>
                <button class="lang-btn flex-1 py-2 border-2 border-black hover:bg-black hover:text-white font-bold text-xs" data-lang="es">ES</button>
            </div>
        </div>
    </header>

    <main class="flex-grow relative z-10">
        
        <!-- Hero Section -->
        <section class="py-20 px-6 text-center relative overflow-hidden">
            <div class="container mx-auto max-w-4xl relative z-10">
                <h1 class="text-5xl md:text-8xl font-black mb-8 leading-tight animate-on-scroll" data-key="hero_title">
                    Faire les Courses
                </h1>
                
                <div class="inline-block bg-white border-[3px] border-black p-6 transform -rotate-1 shadow-[8px_8px_0_0_#000] mb-12 max-w-3xl animate-on-scroll delay-1">
                    <p class="text-xl md:text-2xl font-bold text-gray-800" data-key="hero_subtitle">
                        ÂÉèÊú¨Âú∞‰∫∫‰∏ÄÊ†∑Ë¥≠Áâ©„ÄÇÊéåÊè°Ê≥ïÂõΩÁîüÊ¥ªÂøÖÂ§áÁöÑÂïÜÂ∫óËØçÊ±á‰∏éÂÆûÁî®ÂØπËØù„ÄÇ
                    </p>
                </div>
            </div>
        </section>

        <!-- Marquee -->
        <div class="marquee-container">
            <div class="marquee-content">
                BOULANGERIE ‚Ä¢ PHARMACIE ‚Ä¢ MODE ‚Ä¢ SHOPPING ‚Ä¢ SUPERMARCH√â ‚Ä¢ PARIS ‚Ä¢ STYLE ‚Ä¢ BOULANGERIE ‚Ä¢ PHARMACIE ‚Ä¢ MODE ‚Ä¢ SHOPPING ‚Ä¢
            </div>
        </div>

        <!-- 1. ÂïÜÂ∫óÁ±ªÂûã (Shops) -->
        <section id="shops" class="py-20 px-6">
            <div class="container mx-auto max-w-6xl">
                <div class="mb-16 text-center animate-on-scroll">
                    <span class="section-tag bg-[var(--c-yellow)] text-black" data-key="tab_shops">ÂïÜÂ∫óÁ±ªÂûã</span>
                </div>
                
                <!-- ËøôÈáåÁöÑÂÜÖÂÆπÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàêÔºå‰ª•‰øùÊåÅÂ∏ÉÂ±ÄÁÅµÊ¥ª -->
                <div id="shops-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- JS Rendered Cards -->
                </div>
            </div>
        </section>

        <!-- 2. ÂÆûÁî®ÂØπËØù (Templates) -->
        <section id="templates" class="py-20 px-6 bg-[var(--c-cyan)] border-y-[3px] border-black">
            <div class="container mx-auto max-w-4xl">
                <div class="mb-16 text-center animate-on-scroll">
                    <span class="section-tag bg-white text-black border-2 border-black" data-key="tab_templates">ÂÆûÁî®ÂØπËØùÊ®°Êùø</span>
                </div>

                <div id="templates-container" class="space-y-12">
                    <!-- JS Rendered Dialogue Cards -->
                </div>
            </div>
        </section>

        <!-- 3. ËØçÊ±áÊµãÈ™å (Quiz) -->
        <section id="quiz" class="py-20 px-6">
            <div class="container mx-auto max-w-3xl">
                <div class="mb-12 text-center animate-on-scroll">
                    <span class="section-tag bg-[var(--c-pink)] text-white border-black" data-key="quiz_title">ËØçÊ±áÊµãÈ™å</span>
                </div>

                <div class="neo-card p-8 bg-white animate-on-scroll">
                    <div class="flex justify-between items-center mb-8 border-b-2 border-black pb-4">
                        <h3 class="text-2xl font-black uppercase" data-key="quiz_header">Challenge Time</h3>
                        <div class="flex gap-2">
                             <button id="change-quiz" class="neo-btn px-4 py-2 text-xs bg-[var(--c-purple)] text-black shadow-[2px_2px_0_0_#000]">
                                <i class="ph-bold ph-arrows-clockwise mr-2"></i> <span data-key="btn_change_quiz">Êç¢‰∏ÄÂ•óÈ¢ò</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="quiz-container" class="space-y-8">
                        <!-- Quiz Items -->
                    </div>

                    <div class="mt-8 pt-8 border-t-2 border-black flex flex-col md:flex-row gap-4 justify-center">
                        <button id="submit-quiz" class="neo-btn px-8 py-3 bg-black text-white text-lg hover:bg-[var(--c-yellow)] hover:text-black shadow-[4px_4px_0_0_var(--c-cyan)]" data-key="btn_submit">Êèê‰∫§Á≠îÊ°à</button>
                        <button id="reset-quiz" class="neo-btn px-8 py-3 bg-white text-black border-black text-lg hover:bg-gray-100" data-key="btn_reset">ÈáçÁΩÆ</button>
                    </div>
                    <div id="quiz-results" class="mt-6 text-center text-xl font-black h-8"></div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white py-12 text-center border-t-[3px] border-black">
        <div class="container mx-auto px-6">
             <div class="flex justify-center mb-4">
                 <i class="ph-duotone ph-shopping-cart text-4xl text-black"></i>
             </div>
             <p class="font-bold font-mono text-sm" data-key="footer_text">&copy; 2025 Hugo.</p>
        </div>
    </footer>

    <!-- Back to Top -->
    <button id="back-to-top" title="Back to Top">
        <i class="ph-bold ph-arrow-up text-xl"></i>
    </button>

    <!-- Note Modal -->
    <div id="note-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4 border-b-2 border-black pb-2">
                <h4 class="font-black text-xl">Note</h4>
                <button id="close-modal" class="hover:bg-black hover:text-white p-1 transition-colors"><i class="ph-bold ph-x text-xl"></i></button>
            </div>
            <p id="modal-text" class="font-bold text-lg leading-relaxed"></p>
        </div>
    </div>

    <script>
        // --- Data & Logic ---
        
        const translations = {
            zh: {
                page_title: "Ê≥ïÂºèË¥≠Áâ©ÊåáÂçó", nav_title: "Ê≥ïÂºèË¥≠Áâ©",
                hero_title: "Ë¥≠Áâ©‰∏éÁîüÊ¥ª", hero_subtitle: "ÂÉèÊú¨Âú∞‰∫∫‰∏ÄÊ†∑Ë¥≠Áâ©„ÄÇÊéåÊè°Ê≥ïÂõΩÁîüÊ¥ªÂøÖÂ§áÁöÑÂïÜÂ∫óËØçÊ±á‰∏éÂÆûÁî®ÂØπËØù„ÄÇ",
                tab_shops: "ÂïÜÂ∫óÁ±ªÂûã", tab_templates: "ÂÆûÁî®ÂØπËØù", tab_quiz: "ËØçÊ±áÊµãÈ™å",
                quiz_title: "ÂïÜÂ∫óËØçÊ±áÂ§ßÊåëÊàò", quiz_header: "ÊµãËØï‰Ω†ÁöÑÁü•ËØÜ",
                btn_submit: "Êèê‰∫§Á≠îÊ°à", btn_reset: "ÂÜçËØï‰∏ÄÊ¨°", btn_change_quiz: "Êç¢‰∏ÄÂ•óÈ¢ò",
                footer_text: "¬© 2025 Hugo ÁâàÊùÉÊâÄÊúâ",
                quiz_result: "‰Ω†Á≠îÂØπ‰∫Ü {score} / {total} È¢òÔºÅ", quiz_perfect: "Â§™Ê£í‰∫ÜÔºÅüéâ"
            },
            en: {
                page_title: "French Shopping Guide", nav_title: "Shopping Guide",
                hero_title: "Shopping & Life", hero_subtitle: "Shop like a local. Master essential French vocabulary and phrases for daily shopping.",
                tab_shops: "Shop Types", tab_templates: "Dialogues", tab_quiz: "Vocabulary Quiz",
                quiz_title: "Vocabulary Challenge", quiz_header: "Test Your Knowledge",
                btn_submit: "Submit", btn_reset: "Retry", btn_change_quiz: "New Questions",
                footer_text: "¬© 2025 Hugo. All rights reserved.",
                quiz_result: "You got {score} / {total} correct!", quiz_perfect: "Excellent! üéâ"
            },
            es: {
                page_title: "Gu√≠a de Compras", nav_title: "Gu√≠a de Compras",
                hero_title: "Compras y Vida", hero_subtitle: "Compra como un local. Domina el vocabulario y las frases esenciales en franc√©s.",
                tab_shops: "Tipos de Tiendas", tab_templates: "Di√°logos", tab_quiz: "Prueba",
                quiz_title: "Desaf√≠o de Vocabulario", quiz_header: "Pon a prueba tus conocimientos",
                btn_submit: "Enviar", btn_reset: "Reintentar", btn_change_quiz: "Nuevas Preguntas",
                footer_text: "¬© 2025 Hugo. Todos los derechos reservados.",
                quiz_result: "¬°Acertaste {score} de {total}!", quiz_perfect: "¬°Excelente! üéâ"
            }
        };

        const shopData = [
            {
                category: { zh: "È£üÂìÅ‰∏éÈ•ÆÂìÅ", en: "Food & Drinks", es: "Alimentos y Bebidas" },
                icon: "ph-bread", color: "var(--c-yellow)",
                items: [
                    { fr: "Boulangerie", trans: { zh: "Èù¢ÂåÖÂ∫ó", en: "Bakery", es: "Panader√≠a" } },
                    { fr: "P√¢tisserie", trans: { zh: "Á≥ïÁÇπÂ∫ó", en: "Pastry shop", es: "Pasteler√≠a" } },
                    { fr: "Boucherie", trans: { zh: "ËÇâÂ∫ó", en: "Butcher's", es: "Carnicer√≠a" } },
                    { fr: "Poissonnerie", trans: { zh: "È±ºÂ∫ó", en: "Fishmonger's", es: "Pescader√≠a" } },
                    { fr: "√âpicerie", trans: { zh: "ÊùÇË¥ßÂ∫ó", en: "Grocery", es: "Tienda de abarrotes" } },
                    { fr: "March√©", trans: { zh: "Èú≤Â§©Â∏ÇÂú∫", en: "Market", es: "Mercado" } }
                ]
            },
            {
                category: { zh: "ÊúçË£Ö‰∏éÊó∂Â∞ö", en: "Clothing & Fashion", es: "Ropa y Moda" },
                icon: "ph-t-shirt", color: "var(--c-pink)",
                items: [
                    { fr: "Magasin de v√™tements", trans: { zh: "ÊúçË£ÖÂ∫ó", en: "Clothing store", es: "Tienda de ropa" } },
                    { fr: "Boutique", trans: { zh: "Á≤æÂìÅÂ∫ó", en: "Boutique", es: "Boutique" } },
                    { fr: "Magasin de chaussures", trans: { zh: "ÈûãÂ∫ó", en: "Shoe store", es: "Zapater√≠a" } },
                    { fr: "Bijouterie", trans: { zh: "Áè†ÂÆùÂ∫ó", en: "Jewelry store", es: "Joyer√≠a" } },
                    { fr: "Friperie", trans: { zh: "‰∫åÊâãÂ∫ó", en: "Thrift store", es: "Tienda de segunda mano" }, note: { zh: "Â§çÂè§Ê∑òË¥ßÁöÑÂ•ΩÂéªÂ§Ñ", en: "Great for vintage finds", es: "Ideal para hallazgos vintage" } }
                ]
            },
            {
                category: { zh: "ÂÅ•Â∫∑‰∏éÁæéÂÆπ", en: "Health & Beauty", es: "Salud y Belleza" },
                icon: "ph-heart", color: "var(--c-cyan)",
                items: [
                    { fr: "Pharmacie", trans: { zh: "ËçØÂ∫ó", en: "Pharmacy", es: "Farmacia" } },
                    { fr: "Parapharmacie", trans: { zh: "ËçØÂ¶ÜÂ∫ó", en: "Parapharmacy", es: "Parafarmacia" } },
                    { fr: "Parfumerie", trans: { zh: "È¶ôÊ∞¥Â∫ó", en: "Perfumery", es: "Perfumer√≠a" } },
                    { fr: "Salon de coiffure", trans: { zh: "ÁêÜÂèëÂ∫ó", en: "Hair salon", es: "Peluquer√≠a" } }
                ]
            },
            {
                category: { zh: "‰∏ì‰∏öÊúçÂä°", en: "Services", es: "Servicios" },
                icon: "ph-buildings", color: "var(--c-purple)",
                items: [
                    { fr: "Tabac", trans: { zh: "ÁÉüËçâÂ∫ó", en: "Tobacconist", es: "Estanco" }, note: { zh: "‰π∞ÈÇÆÁ•®„ÄÅÂΩ©Á•®ÁöÑÂú∞Êñπ", en: "Buy stamps, lottery tickets here", es: "Compra sellos, loter√≠a aqu√≠" } },
                    { fr: "Librairie", trans: { zh: "‰π¶Â∫ó", en: "Bookshop", es: "Librer√≠a" } },
                    { fr: "Fleuriste", trans: { zh: "Ëä±Â∫ó", en: "Florist", es: "Florister√≠a" } },
                    { fr: "Poste", trans: { zh: "ÈÇÆÂ±Ä", en: "Post office", es: "Oficina de correos" } }
                ]
            }
        ];

        const templateData = [
            {
                title: { zh: "ÈóÆÂÄô‰∏éÈúÄÊ±Ç", en: "Greeting & Needs", es: "Saludos y Necesidades" },
                lines: [
                    { fr: "Bonjour, Monsieur / Madame.", trans: { zh: "‰Ω†Â•ΩÔºåÂÖàÁîü/Â•≥Â£´„ÄÇ", en: "Hello, Sir / Madam.", es: "Buenos d√≠as, Se√±or / Se√±ora." } },
                    { fr: "Je cherche...", trans: { zh: "ÊàëÂú®Êâæ...", en: "I'm looking for...", es: "Estoy buscando..." } },
                    { fr: "Je voudrais...", trans: { zh: "ÊàëÊÉ≥Ë¶Å...", en: "I would like...", es: "Quisiera..." } }
                ]
            },
            {
                title: { zh: "ËØ¢ÈóÆ‰ø°ÊÅØ", en: "Asking Info", es: "Pedir Informaci√≥n" },
                lines: [
                    { fr: "C'est combien ?", trans: { zh: "Ëøô‰∏™Â§öÂ∞ëÈí±Ôºü", en: "How much is it?", es: "¬øCu√°nto cuesta?" } },
                    { fr: "Est-ce que je peux essayer ?", trans: { zh: "ÊàëÂèØ‰ª•ËØïÁ©øÂêóÔºü", en: "Can I try it on?", es: "¬øPuedo prob√°rmelo?" } },
                    { fr: "Vous avez d'autres couleurs ?", trans: { zh: "ÊúâÂà´ÁöÑÈ¢úËâ≤ÂêóÔºü", en: "Do you have other colors?", es: "¬øTiene otros colores?" } }
                ]
            },
            {
                title: { zh: "ÁªìË¥¶‰∏éÂëäÂà´", en: "Payment & Goodbye", es: "Pago y Despedida" },
                lines: [
                    { fr: "Je peux payer par carte ?", trans: { zh: "ÂèØ‰ª•Âà∑Âç°ÂêóÔºü", en: "Can I pay by card?", es: "¬øPuedo pagar con tarjeta?" } },
                    { fr: "Merci, bonne journ√©e !", trans: { zh: "Ë∞¢Ë∞¢ÔºåÁ•ùÊÇ®ÊÑâÂø´ÔºÅ", en: "Thank you, have a good day!", es: "¬°Gracias, que tenga un buen d√≠a!" } }
                ]
            }
        ];

        const quizDataSets = [
             [
                { q: { zh: "‰π∞ËçØÂéªÂì™ÈáåÔºü", en: "Where to buy medicine?", es: "¬øD√≥nde comprar medicina?" }, a: "Pharmacie", ops: ["Boulangerie", "Pharmacie", "Librairie", "Gare"] },
                { q: { zh: "‰π∞Èù¢ÂåÖÂéªÂì™ÈáåÔºü", en: "Where to buy bread?", es: "¬øD√≥nde comprar pan?" }, a: "Boulangerie", ops: ["Boucherie", "Boulangerie", "Poste", "Tabac"] },
                { q: { zh: "'Librairie' ÊòØ‰ªÄ‰πàÊÑèÊÄùÔºü", en: "What is 'Librairie'?", es: "¬øQu√© es 'Librairie'?" }, a: "Bookshop", ops: { zh:["Âõæ‰π¶È¶Ü", "‰π¶Â∫ó", "ÊñáÂÖ∑Â∫ó"], en:["Library", "Bookshop", "Stationery"], es:["Biblioteca", "Librer√≠a", "Papeler√≠a"] } },
                { q: { zh: "‰π∞ËÇâÂéªÂì™ÈáåÔºü", en: "Where to buy meat?", es: "¬øD√≥nde comprar carne?" }, a: "Boucherie", ops: ["Boucherie", "Fleuriste", "√âpicerie", "Parfumerie"] }
            ],
            [
                { q: { zh: "‰π∞Ëä±ÂéªÂì™ÈáåÔºü", en: "Where to buy flowers?", es: "¬øD√≥nde comprar flores?" }, a: "Fleuriste", ops: ["Fleuriste", "Tabac", "Banque", "March√©"] },
                { q: { zh: "‰π∞ÈÇÆÁ•®ÂéªÂì™ÈáåÔºü", en: "Where to buy stamps?", es: "¬øD√≥nde comprar sellos?" }, a: "Tabac", ops: ["Tabac", "Boutique", "Pharmacie", "Cinema"] },
                { q: { zh: "'Je voudrais...' ÊÑèÊÄùÊòØÔºü", en: "Meaning of 'Je voudrais...'?", es: "¬øSignificado de 'Je voudrais...'?" }, a: "I would like", ops: { zh:["ÊàëÁúã...", "ÊàëÊÉ≥Ë¶Å...", "ÊàëÊúâ..."], en:["I see...", "I would like...", "I have..."], es:["Veo...", "Quisiera...", "Tengo..."] } }
            ]
        ];

        let currentLang = 'zh';
        let currentQuizIndex = 0;

        // --- Functions ---

        function renderShops() {
            const container = document.getElementById('shops-container');
            container.innerHTML = '';
            shopData.forEach((cat, index) => {
                const card = document.createElement('div');
                card.className = 'neo-card bg-white animate-on-scroll';
                card.style.animationDelay = `${index * 0.1}s`;
                
                // Header
                const header = document.createElement('div');
                header.className = 'p-4 border-b-2 border-black flex items-center gap-3';
                header.style.backgroundColor = cat.color;
                header.innerHTML = `<i class="ph-duotone ${cat.icon} text-2xl"></i><h3 class="font-black text-lg uppercase">${cat.category[currentLang]}</h3>`;
                card.appendChild(header);

                // List
                const list = document.createElement('div');
                list.className = 'p-6 flex flex-col';
                cat.items.forEach(item => {
                    const row = document.createElement('div');
                    row.className = 'shop-item';
                    
                    let noteHtml = '';
                    if(item.note && item.note[currentLang]) {
                        noteHtml = `<button class="ml-2 text-[var(--c-purple)] hover:text-black transition-colors tooltip-btn" data-note="${item.note[currentLang]}"><i class="ph-bold ph-info"></i></button>`;
                    }

                    row.innerHTML = `
                        <span class="font-black text-lg">${item.fr}</span>
                        <div class="flex items-center">
                            <span class="text-sm font-bold text-gray-500">${item.trans[currentLang]}</span>
                            ${noteHtml}
                        </div>
                    `;
                    list.appendChild(row);
                });
                card.appendChild(list);
                container.appendChild(card);
            });
        }

        function renderTemplates() {
            const container = document.getElementById('templates-container');
            container.innerHTML = '';
            templateData.forEach((tpl, index) => {
                const group = document.createElement('div');
                group.className = 'animate-on-scroll';
                group.innerHTML = `<h3 class="text-2xl font-black mb-6 text-white text-stroke-black" style="-webkit-text-stroke: 1px black;">${tpl.title[currentLang]}</h3>`;
                
                const grid = document.createElement('div');
                grid.className = 'grid md:grid-cols-2 gap-6';
                
                tpl.lines.forEach((line, i) => {
                    const bubble = document.createElement('div');
                    bubble.className = `bubble ${i % 2 !== 0 ? 'alt' : ''}`;
                    bubble.innerHTML = `
                        <p class="font-black text-lg mb-1">${line.fr}</p>
                        <p class="text-sm font-bold text-gray-600">${line.trans[currentLang]}</p>
                    `;
                    grid.appendChild(bubble);
                });
                
                group.appendChild(grid);
                container.appendChild(group);
            });
        }

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            const resultDiv = document.getElementById('quiz-results');
            container.innerHTML = '';
            resultDiv.textContent = '';
            document.getElementById('submit-quiz').style.display = 'inline-block';

            const currentSet = quizDataSets[currentQuizIndex];
            
            currentSet.forEach((q, i) => {
                const item = document.createElement('div');
                item.className = 'border-2 border-black p-4 bg-gray-50 quiz-item';
                
                const question = document.createElement('p');
                question.className = 'font-black text-lg mb-4';
                question.textContent = `${i+1}. ${q.q[currentLang]}`;
                item.appendChild(question);

                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'grid grid-cols-2 gap-3';
                
                // Handle localized options
                const options = Array.isArray(q.ops) ? q.ops : q.ops[currentLang];
                const answer = Array.isArray(q.ops) ? q.a : (q.ops.en ? (q.a === "Bookshop" ? "‰π¶Â∫ó" : q.a) : q.a); // Simplified logic for demo
                // Real logic: align answer key with localized options index if needed, or strictly match string. 
                // For this demo, we'll assume 'a' matches one of the 'ops' or needs simple mapping.
                // Let's make it robust:
                
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'quiz-opt neo-btn py-2 bg-white hover:bg-black hover:text-white text-sm font-bold border-black w-full';
                    btn.textContent = opt;
                    btn.dataset.val = opt;
                    btn.onclick = () => {
                        item.querySelectorAll('.quiz-opt').forEach(b => {
                            b.classList.remove('bg-black', 'text-white');
                            b.classList.add('bg-white', 'text-black');
                            b.dataset.selected = 'false';
                        });
                        btn.classList.remove('bg-white', 'text-black');
                        btn.classList.add('bg-black', 'text-white');
                        btn.dataset.selected = 'true';
                    };
                    optionsDiv.appendChild(btn);
                });
                item.appendChild(optionsDiv);
                container.appendChild(item);
            });
        }

        function checkQuiz() {
            const currentSet = quizDataSets[currentQuizIndex];
            let score = 0;
            const items = document.querySelectorAll('.quiz-item');
            
            items.forEach((item, i) => {
                const selectedBtn = item.querySelector('[data-selected="true"]');
                const correctVal = Array.isArray(currentSet[i].ops) ? currentSet[i].a : (currentLang === 'zh' && currentSet[i].a === 'Bookshop' ? '‰π¶Â∫ó' : currentSet[i].a); 
                // Note: Simplified verification. In prod, compare indices.
                
                // Very basic check for demo purposes (string match or index match if mapped)
                // Let's assume correct answer text is known.
                // For "Librairie": ZH ops: ["Âõæ‰π¶È¶Ü", "‰π¶Â∫ó", "ÊñáÂÖ∑Â∫ó"]. Correct: "‰π¶Â∫ó"
                
                let isCorrect = false;
                if (selectedBtn) {
                    // Dynamic check logic adjustment for this specific data structure
                    if (currentSet[i].q.zh.includes("Librairie") && currentLang === 'zh') isCorrect = selectedBtn.textContent === "‰π¶Â∫ó";
                    else if (currentSet[i].q.zh.includes("Librairie") && currentLang === 'es') isCorrect = selectedBtn.textContent === "Librer√≠a";
                    else if (currentSet[i].q.zh.includes("Je voudrais") && currentLang === 'zh') isCorrect = selectedBtn.textContent === "ÊàëÊÉ≥Ë¶Å...";
                    else if (currentSet[i].q.zh.includes("Je voudrais") && currentLang === 'es') isCorrect = selectedBtn.textContent === "Quisiera...";
                    else isCorrect = selectedBtn.textContent === currentSet[i].a;
                }

                if (isCorrect) {
                    score++;
                    item.classList.add('bg-green-100', 'border-green-500');
                } else {
                    item.classList.add('bg-red-100', 'border-red-500');
                }
                
                // Disable buttons
                item.querySelectorAll('button').forEach(b => b.disabled = true);
            });

            const resultText = translations[currentLang].quiz_result.replace('{score}', score).replace('{total}', currentSet.length);
            document.getElementById('quiz-results').textContent = score === currentSet.length ? resultText + " " + translations[currentLang].quiz_perfect : resultText;
            document.getElementById('submit-quiz').style.display = 'none';
        }

        function updateLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            
            // Update static text
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.dataset.key;
                if(translations[lang][key]) el.innerHTML = translations[lang][key];
            });

            // Update buttons state
            document.querySelectorAll('.lang-btn').forEach(btn => {
                if(btn.dataset.lang === lang) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // Re-render dynamic content
            renderShops();
            renderTemplates();
            renderQuiz();
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            updateLanguage('zh'); // Init

            // Lang Buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => updateLanguage(btn.dataset.lang));
            });

            // Mobile Menu
            const menuBtn = document.getElementById('menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            menuBtn.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
            mobileMenu.querySelectorAll('a').forEach(a => a.addEventListener('click', () => mobileMenu.classList.add('hidden')));

            // Quiz Actions
            document.getElementById('submit-quiz').addEventListener('click', checkQuiz);
            document.getElementById('reset-quiz').addEventListener('click', renderQuiz);
            document.getElementById('change-quiz').addEventListener('click', () => {
                currentQuizIndex = (currentQuizIndex + 1) % quizDataSets.length;
                renderQuiz();
            });

            // Modal Logic (Delegation)
            const modal = document.getElementById('note-modal');
            const modalText = document.getElementById('modal-text');
            const closeModal = document.getElementById('close-modal');
            
            document.getElementById('shops-container').addEventListener('click', (e) => {
                const btn = e.target.closest('.tooltip-btn');
                if (btn) {
                    modalText.textContent = btn.dataset.note;
                    modal.classList.add('active');
                }
            });
            
            closeModal.addEventListener('click', () => modal.classList.remove('active'));
            modal.addEventListener('click', (e) => { if(e.target === modal) modal.classList.remove('active'); });

            // Scroll Animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.remove('scroll-hidden');
                    }
                });
            }, { threshold: 0.1 });

            // Add hidden class initially to dynamic elements after render? 
            // Or just let CSS handle opacity transition from 0->1 if class not present?
            // To be safe and robust, we just rely on the CSS defaults (opacity: 1) and add .scroll-hidden via JS if needed.
            // For this specific request "fix blank page", I removed default opacity:0 in CSS. 
            // Now we add animation class.
            
            document.querySelectorAll('.animate-on-scroll').forEach(el => {
                el.classList.add('scroll-hidden'); // Hide via JS
                observer.observe(el);
            });
            
            // Back to Top
            const backToTop = document.getElementById('back-to-top');
            window.addEventListener('scroll', () => {
                backToTop.style.display = window.scrollY > 300 ? 'block' : 'none';
            });
            backToTop.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));
        });

    </script>
</body>
</html>