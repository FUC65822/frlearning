<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale-1.0">
    <title id="html-title">å­¦ä¹ æ³•è¯­ï¼šå•†åº—è´­ç‰© (Apprendre le franÃ§ais : Faire les courses)</title>
    <!-- å¼•å…¥Tailwind CSSæ¡†æ¶ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥Googleå­—ä½“ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* è‡ªå®šä¹‰æ ·å¼ */
        body {
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            background-color: #f0f4f8; /* æ·¡é›…çš„èƒŒæ™¯è‰² */
        }
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background-color: #3b82f6; /* è“è‰² */
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .quiz-option:hover {
            background-color: #eff6ff; /* æµ…è“è‰² */
        }
        .quiz-option.selected {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .quiz-option.correct {
            background-color: #22c55e; /* ç»¿è‰² */
            color: white;
            border-color: #22c55e;
        }
        .quiz-option.incorrect {
            background-color: #ef4444; /* çº¢è‰² */
            color: white;
            border-color: #ef4444;
        }
        .tooltip-trigger {
            cursor: pointer;
            color: #dc2626; /* çº¢è‰² */
            font-weight: 600;
            border-bottom: 2px dotted #fca5a5;
            transition: color 0.2s;
        }
        .tooltip-trigger:hover {
            color: #b91c1c;
        }
        /* æ›´æ–°ï¼šè¯­è¨€åˆ‡æ¢æŒ‰é’®æ ·å¼ */
        .lang-btn {
            background-color: #e5e7eb; /* gray-200 */
            color: #374151; /* gray-700 */
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            border: none;
            cursor: pointer;
        }
        .lang-btn:hover {
            background-color: #d1d5db; /* gray-300 */
        }
        .lang-btn.active {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <!-- é¡µé¢å®¹å™¨ -->
    <div class="container mx-auto p-4 md:p-8 max-w-5xl">

        <!-- æ ‡é¢˜åŒºåŸŸ -->
        <header class="text-center mb-4">
            <h1 id="main-title" class="text-3xl md:text-4xl font-bold text-blue-600">å­¦ä¹ æ³•è¯­ï¼šè®¤è¯†å„ç§å•†åº—</h1>
            <p class="text-lg text-gray-600 mt-2">Apprendre le franÃ§ais : Les types de magasins</p>
        </header>

        <!-- è¯­è¨€åˆ‡æ¢ -->
        <div id="lang-switcher" class="flex justify-center items-center space-x-2 md:space-x-4 mb-8">
            <button class="lang-btn active" onclick="changeLanguage('zh')">ä¸­æ–‡</button>
            <button class="lang-btn" onclick="changeLanguage('en')">English</button>
            <button class="lang-btn" onclick="changeLanguage('es')">EspaÃ±ol</button>
        </div>

        <!-- å¯¼èˆªé€‰é¡¹å¡ -->
        <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8 bg-gray-100 p-2 rounded-full">
            <button id="tab-shops" class="tab-button active px-4 py-2 rounded-full font-semibold" onclick="showTab('shops')">å•†åº—ç±»å‹</button>
            <button id="tab-quiz" class="tab-button px-4 py-2 rounded-full font-semibold" onclick="showTab('quiz')">è¯æ±‡æµ‹éªŒ</button>
            <button id="tab-templates" class="tab-button px-4 py-2 rounded-full font-semibold" onclick="showTab('dialogues')">å®ç”¨æ¨¡æ¿</button>
        </div>

        <!-- å†…å®¹åŒºåŸŸ -->
        <main>
            <!-- å•†åº—ç±»å‹æ¿å— -->
            <div id="shops" class="tab-content active space-y-8"></div>
            <!-- è¯æ±‡æµ‹éªŒæ¿å— -->
            <div id="quiz" class="tab-content">
                <div class="card p-6 md:p-8">
                    <h2 id="quiz-title" class="text-2xl font-bold mb-6 text-gray-700">å•†åº—è¯æ±‡æµ‹éªŒ</h2>
                    <div id="quiz-container" class="space-y-6"></div>
                    <div class="mt-8 text-center">
                        <button id="submit-quiz" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-full hover:bg-blue-700 transition-colors">æäº¤ç­”æ¡ˆ</button>
                        <button id="reset-quiz" class="ml-4 bg-gray-500 text-white font-bold py-2 px-6 rounded-full hover:bg-gray-600 transition-colors">å†è¯•ä¸€æ¬¡</button>
                        <button id="change-quiz" class="ml-4 bg-green-600 text-white font-bold py-2 px-6 rounded-full hover:bg-green-700 transition-colors mt-2 md:mt-0">æ¢ä¸€å¥—é¢˜</button>
                    </div>
                    <div id="quiz-results" class="mt-6 text-center text-xl font-semibold"></div>
                </div>
            </div>
            <!-- å®ç”¨æ¨¡æ¿æ¿å— -->
            <div id="dialogues" class="tab-content"></div>
        </main>

        <!-- é¡µè„š -->
        <footer class="text-center mt-12 text-gray-500">
            <p id="footer-text">&copy; 2025 Hugo ç‰ˆæƒæ‰€æœ‰</p>
        </footer>
    </div>

    <!-- æç¤ºå¼¹çª—HTMLç»“æ„ -->
    <div id="note-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full relative">
            <button id="close-modal" class="absolute top-2 right-3 text-2xl text-gray-500 hover:text-gray-800 transition-colors">&times;</button>
            <p id="modal-text" class="text-gray-700 leading-relaxed"></p>
        </div>
    </div>

    <script>
        // --- å…¨å±€å˜é‡ ---
        let currentLanguage = 'zh';
        let currentQuizSetIndex = 0;
        let userAnswers = {};

        // --- å…ƒç´ è·å– ---
        const shopsContainer = document.getElementById('shops');
        const quizContainer = document.getElementById('quiz-container');
        const submitButton = document.getElementById('submit-quiz');
        const resetButton = document.getElementById('reset-quiz');
        const changeQuizButton = document.getElementById('change-quiz');
        const resultsContainer = document.getElementById('quiz-results');
        const modal = document.getElementById('note-modal');
        const modalText = document.getElementById('modal-text');
        const closeModalBtn = document.getElementById('close-modal');
        const templatesContainer = document.getElementById('dialogues');

        // --- ç¿»è¯‘æ•°æ® ---
        const translations = {
            zh: {
                htmlTitle: "å­¦ä¹ æ³•è¯­ï¼šå•†åº—è´­ç‰©", mainTitle: "å­¦ä¹ æ³•è¯­ï¼šè®¤è¯†å„ç§å•†åº—", tabShops: "å•†åº—ç±»å‹", tabQuiz: "è¯æ±‡æµ‹éªŒ", tabTemplates: "å®ç”¨æ¨¡æ¿", quizTitle: "å•†åº—è¯æ±‡æµ‹éªŒ", submitQuiz: "æäº¤ç­”æ¡ˆ", resetQuiz: "å†è¯•ä¸€æ¬¡", changeQuiz: "æ¢ä¸€å¥—é¢˜", footerText: "Â© 2025 Hugo ç‰ˆæƒæ‰€æœ‰", quizResultText: (score, total) => `ä½ ç­”å¯¹äº† ${score} / ${total} é¢˜ï¼`, quizCompleteText: "ğŸ‰ å¤ªæ£’äº†ï¼"
            },
            en: {
                htmlTitle: "Learn French: Shopping", mainTitle: "Learn French: Discovering Shops", tabShops: "Shop Types", tabQuiz: "Vocabulary Quiz", tabTemplates: "Useful Templates", quizTitle: "Shop Vocabulary Quiz", submitQuiz: "Submit Answers", resetQuiz: "Try Again", changeQuiz: "New Set", footerText: "Â© 2025 Hugo. All rights reserved.", quizResultText: (score, total) => `You got ${score} / ${total} correct!`, quizCompleteText: "ğŸ‰ Well done!"
            },
            es: {
                htmlTitle: "Aprende FrancÃ©s: De Compras", mainTitle: "Aprende FrancÃ©s: Descubriendo Tiendas", tabShops: "Tipos de Tiendas", tabQuiz: "Prueba de Vocabulario", tabTemplates: "Plantillas Ãštiles", quizTitle: "Prueba de Vocabulario de Tiendas", submitQuiz: "Enviar Respuestas", resetQuiz: "Intentar de Nuevo", changeQuiz: "Nuevo Set", footerText: "Â© 2025 Hugo. Todos los derechos reservados.", quizResultText: (score, total) => `Â¡Acertaste ${score} de ${total}!`, quizCompleteText: "ğŸ‰ Â¡Excelente!"
            }
        };

        // --- åŠ¨æ€å†…å®¹æ•°æ® (å®Œæ•´ç‰ˆ) ---
        const shopData = [
            {
                category: { zh: "ä¸€ã€ é£Ÿå“ä¸é¥®å“", en: "1. Food & Drinks", es: "1. Alimentos y Bebidas" },
                items: [
                    { fr: "Ã  la Boulangerie (f.) / chez le boulanger", translations: { zh: "é¢åŒ…åº—", en: "Bakery", es: "PanaderÃ­a" } },
                    { fr: "Ã  la PÃ¢tisserie (f.) / chez le pÃ¢tissier", translations: { zh: "ç³•ç‚¹åº—", en: "Pastry shop", es: "PastelerÃ­a" } },
                    { fr: "Ã  la Boucherie (f.) / chez le boucher", translations: { zh: "ç”Ÿè‚‰åº—", en: "Butcher's shop", es: "CarnicerÃ­a" } },
                    { fr: "Ã  la Charcuterie (f.) / chez le charcutier", translations: { zh: "ç†Ÿé£Ÿåº—", en: "Delicatessen", es: "CharcuterÃ­a" } },
                    { fr: "Ã  la Poissonnerie (f.) / chez le poissonnier", translations: { zh: "é±¼åº—", en: "Fishmonger's", es: "PescaderÃ­a" } },
                    { fr: "Ã  la Fromagerie (f.) / chez le fromager", translations: { zh: "å¥¶é…ªåº—", en: "Cheese shop", es: "QueserÃ­a" } },
                    { fr: "Ã  l'Ã‰picerie (f.) / chez l'Ã©picier", translations: { zh: "æ‚è´§åº—", en: "Grocery store", es: "Tienda de abarrotes" } },
                    { fr: "chez le Primeur (m.)", translations: { zh: "è”¬æœåº—", en: "Greengrocer's", es: "FruterÃ­a/VerdulerÃ­a" }, note: { zh: "è¾ƒä¹¦é¢, æ—¥å¸¸ç”¨ magasin de fruits et lÃ©gumes æˆ– au marchÃ©", en: "More formal, 'magasin de fruits et lÃ©gumes' or 'au marchÃ©' is common.", es: "MÃ¡s formal, 'magasin de fruits et lÃ©gumes' o 'au marchÃ©' es comÃºn." } },
                    { fr: "Ã  la Cave Ã  vin (f.) / chez le caviste", translations: { zh: "è‘¡è„é…’ä¸“å–åº—", en: "Wine shop", es: "Vinoteca" } },
                    { fr: "Ã  la Chocolaterie (f.) / chez le chocolatier", translations: { zh: "å·§å…‹åŠ›åº—", en: "Chocolate shop", es: "ChocolaterÃ­a" } },
                    { fr: "chez le Glacier (m.)", translations: { zh: "å†°æ·‡æ·‹åº—", en: "Ice cream parlor", es: "HeladerÃ­a" } },
                    { fr: "chez le Traiteur (m.)", translations: { zh: "ç†Ÿé£Ÿå¤–å–åº—", en: "Caterer/Take-out", es: "Tienda de comida para llevar" } }
                ]
            },
            {
                category: { zh: "äºŒã€ å¤§å‹åŠç»¼åˆå•†åº—", en: "2. Department & General Stores", es: "2. Grandes Almacenes y Tiendas Generales" },
                items: [
                    { fr: "au SupermarchÃ© (m.)", translations: { zh: "è¶…å¸‚", en: "Supermarket", es: "Supermercado" } },
                    { fr: "Ã  l'HypermarchÃ© (m.)", translations: { zh: "å¤§å‹è¶…å¸‚", en: "Hypermarket", es: "Hipermercado" } },
                    { fr: "au Grand magasin (m.)", translations: { zh: "ç™¾è´§å…¬å¸", en: "Department store", es: "Gran almacÃ©n" } },
                    { fr: "au MarchÃ© (m.)", translations: { zh: "éœ²å¤©å¸‚åœº", en: "Market", es: "Mercado" } }
                ]
            },
            {
                category: { zh: "ä¸‰ã€ æœè£…ä¸æ—¶å°š", en: "3. Clothing & Fashion", es: "3. Ropa y Moda" },
                items: [
                    { fr: "au Magasin de vÃªtements (m.)", translations: { zh: "æœè£…åº—", en: "Clothing store", es: "Tienda de ropa" } },
                    { fr: "Ã  la Boutique (f.)", translations: { zh: "ç²¾å“åº—", en: "Boutique", es: "Boutique" } },
                    { fr: "au Magasin de chaussures (m.)", translations: { zh: "é‹åº—", en: "Shoe store", es: "ZapaterÃ­a" } },
                    { fr: "Ã  la Bijouterie (f.) / chez le bijoutier", translations: { zh: "ç å®åº—", en: "Jewelry store", es: "JoyerÃ­a" } },
                    { fr: "Ã  la Maroquinerie (f.)", translations: { zh: "çš®å…·åº—", en: "Leather goods store", es: "MarroquinerÃ­a" } },
                    { fr: "Ã  la Friperie (f.)", translations: { zh: "äºŒæ‰‹æœè£…åº—", en: "Second-hand clothing store", es: "Tienda de segunda mano" }, note: { zh: "åå¤å¤é£, ä¹Ÿå¯è¯´ magasin de vÃªtements d'occasion", en: "Has a vintage feel, also called 'magasin de vÃªtements d'occasion'.", es: "Tiene un aire vintage, tambiÃ©n llamado 'magasin de vÃªtements d'occasion'." } }
                ]
            },
            {
                category: { zh: "å››ã€ å¥åº·ä¸ç¾å®¹", en: "4. Health & Beauty", es: "4. Salud y Belleza" },
                items: [
                    { fr: "Ã  la Pharmacie (f.) / chez le pharmacien", translations: { zh: "è¯åº—", en: "Pharmacy", es: "Farmacia" } },
                    { fr: "Ã  la Parapharmacie (f.)", translations: { zh: "è¯å¦†åº—", en: "Parapharmacy (non-prescription)", es: "Parafarmacia" } },
                    { fr: "Ã  la Parfumerie (f.)", translations: { zh: "é¦™æ°´åº—", en: "Perfumery", es: "PerfumerÃ­a" } },
                    { fr: "au Salon de coiffure (m.) / chez le coiffeur", translations: { zh: "ç†å‘åº—", en: "Hair salon", es: "PeluquerÃ­a" } }
                ]
            },
            {
                category: { zh: "äº”ã€ å®¶å±…ä¸å›­è‰º", en: "5. Home & Garden", es: "5. Hogar y JardÃ­n" },
                items: [
                    { fr: "au Magasin de meubles (m.)", translations: { zh: "å®¶å…·åº—", en: "Furniture store", es: "Tienda de muebles" } },
                    { fr: "Ã  la Droguerie (f.)", translations: { zh: "æ—¥åŒ–ç”¨å“åº—", en: "Drugstore (household items)", es: "DroguerÃ­a" }, note: { zh: "æ—§å¼, è¾ƒå°‘è§, æ³¨æ„ä¸ drogue 'æ¯’å“' åŒºåˆ†", en: "Old-fashioned, less common. Not to be confused with 'drogue' (drugs).", es: "Anticuado, menos comÃºn. No confundir con 'drogue' (drogas)." } },
                    { fr: "Ã  la Quincaillerie (f.) / chez le quincaillier", translations: { zh: "äº”é‡‘åº—", en: "Hardware store", es: "FerreterÃ­a" } },
                    { fr: "chez le Fleuriste (m./f.)", translations: { zh: "èŠ±åº—", en: "Florist's", es: "FloristerÃ­a" } }
                ]
            },
            {
                category: { zh: "å…­ã€ ä¹¦ç±ã€æ–‡å…·ä¸åª’ä½“", en: "6. Books, Stationery & Media", es: "6. Libros, PapelerÃ­a y Medios" },
                items: [
                    { fr: "Ã  la Librairie (f.) / chez le libraire", translations: { zh: "ä¹¦åº—", en: "Bookshop", es: "LibrerÃ­a" } },
                    { fr: "Ã  la Papeterie (f.)", translations: { zh: "æ–‡å…·åº—", en: "Stationery shop", es: "PapelerÃ­a" } },
                    { fr: "Ã  la Maison de la presse (f.)", translations: { zh: "æŠ¥åˆŠäº­", en: "Newsstand", es: "Quiosco de prensa" } },
                    { fr: "chez le Disquaire (m.)", translations: { zh: "å”±ç‰‡åº—", en: "Record store", es: "Tienda de discos" } }
                ]
            },
            {
                category: { zh: "ä¸ƒã€ ä¸“ä¸šåº—ä¸æœåŠ¡", en: "7. Specialty Shops & Services", es: "7. Tiendas Especializadas y Servicios" },
                items: [
                    { fr: "au Tabac (m.) / chez le buraliste", translations: { zh: "çƒŸè‰åº—", en: "Tobacconist's", es: "Estanco" } },
                    { fr: "au Magasin de jouets (m.)", translations: { zh: "ç©å…·åº—", en: "Toy store", es: "JugueterÃ­a" } },
                    { fr: "chez l'Opticien (m.)", translations: { zh: "çœ¼é•œåº—", en: "Optician's", es: "Ã“ptica" } },
                    { fr: "au Pressing (m.)", translations: { zh: "å¹²æ´—åº—", en: "Dry cleaner's", es: "TintorerÃ­a" } },
                    { fr: "Ã  la Banque (f.)", translations: { zh: "é“¶è¡Œ", en: "Bank", es: "Banco" } },
                    { fr: "au Bureau de poste (m.) / Ã  la Poste", translations: { zh: "é‚®å±€", en: "Post office", es: "Oficina de correos" } }
                ]
            }
        ];
        
        const allQuizData = [
            [
                { question: { zh: "å”®å–æ–°é²œæµ·é²œã€é±¼ç±»çš„å•†åº—å«ä»€ä¹ˆï¼Ÿ", en: "What is a shop that sells fresh seafood and fish called?", es: "Â¿CÃ³mo se llama una tienda que vende mariscos y pescado frescos?" }, options: ["Boucherie", "Poissonnerie", "Fromagerie", "Charcuterie"], answer: "Poissonnerie" },
                { question: { zh: "'Librairie (f.)' æ˜¯æŒ‡ä»€ä¹ˆç±»å‹çš„å•†åº—ï¼Ÿ", en: "What type of shop is a 'Librairie (f.)'?", es: "Â¿QuÃ© tipo de tienda es una 'Librairie (f.)'?" }, options: { zh: ["å›¾ä¹¦é¦†", "æ–‡å…·åº—", "ä¹¦åº—", "æŠ¥åˆŠäº­"], en: ["Library", "Stationery shop", "Bookshop", "Newsstand"], es: ["Biblioteca", "PapelerÃ­a", "LibrerÃ­a", "Quiosco"] }, answer: "Bookshop", answer_es: "LibrerÃ­a", answer_zh: "ä¹¦åº—" },
                { question: { zh: "åœ¨æ³•å›½ä¹°åˆ°å¤„æ–¹è¯åº”è¯¥å»å“ªé‡Œï¼Ÿ", en: "Where should you go in France to buy prescription medicine?", es: "Â¿A dÃ³nde deberÃ­as ir en Francia para comprar medicamentos con receta?" }, options: ["Parapharmacie", "SupermarchÃ©", "Droguerie", "Pharmacie"], answer: "Pharmacie" },
                { question: { zh: "å»ç†å‘åº—ï¼Œæˆ‘ä»¬å¯ä»¥è¯´å» 'chez le ...'ï¼Ÿ", en: "To go to the hair salon, we can say we're going to 'chez le ...'?", es: "Para ir a la peluquerÃ­a, Â¿podemos decir que vamos a 'chez le ...'?" }, options: ["boulanger", "coiffeur", "pharmacien", "fleuriste"], answer: "coiffeur" },
                { question: { zh: "ä¹°å–äºŒæ‰‹è¡£æœçš„å•†åº—å«ä»€ä¹ˆï¼Ÿ", en: "What is a shop that sells second-hand clothes called?", es: "Â¿CÃ³mo se llama una tienda que vende ropa de segunda mano?" }, options: ["Boutique", "Magasin de vÃªtements", "Friperie", "Lingerie"], answer: "Friperie" }
            ],
            [
                { question: { zh: "å”®å–ç«è…¿ã€é¦™è‚ çš„ 'Charcuterie' æ˜¯æŒ‡ï¼Ÿ", en: "What does 'Charcuterie', which sells ham and sausages, refer to?", es: "Â¿A quÃ© se refiere 'Charcuterie', que vende jamÃ³n y salchichas?" }, options: { zh: ["ç”Ÿè‚‰åº—", "ç†Ÿé£Ÿåº—", "é±¼åº—", "å¥¶é…ªåº—"], en: ["Butcher's", "Delicatessen", "Fishmonger's", "Cheese shop"], es: ["CarnicerÃ­a", "CharcuterÃ­a", "PescaderÃ­a", "QueserÃ­a"] }, answer: "Delicatessen", answer_es: "CharcuterÃ­a", answer_zh: "ç†Ÿé£Ÿåº—" },
                { question: { zh: "å» 'chez le fleuriste' æ˜¯ä¸ºäº†ä¹°ä»€ä¹ˆï¼Ÿ", en: "What do you buy at 'chez le fleuriste'?", es: "Â¿QuÃ© compras en 'chez le fleuriste'?" }, options: { zh: ["å®¶å…·", "é²œèŠ±", "ä¹¦ç±", "è¯å“"], en: ["Furniture", "Flowers", "Books", "Medicine"], es: ["Muebles", "Flores", "Libros", "Medicinas"] }, answer: "Flowers", answer_es: "Flores", answer_zh: "é²œèŠ±" },
                { question: { zh: "'HypermarchÃ©' å’Œ 'SupermarchÃ©' ç›¸æ¯”ï¼Œå“ªä¸ªé€šå¸¸æ›´å¤§ï¼Ÿ", en: "Compared to a 'SupermarchÃ©', which one is usually bigger?", es: "En comparaciÃ³n con un 'SupermarchÃ©', Â¿cuÃ¡l es generalmente mÃ¡s grande?" }, options: ["HypermarchÃ©", "SupermarchÃ©", "Same size", "Not sure"], answer: "HypermarchÃ©" },
                { question: { zh: "ä¹°æŠ¥çº¸æ‚å¿—ï¼Œä½ åº”è¯¥å»å“ªé‡Œï¼Ÿ", en: "Where should you go to buy newspapers and magazines?", es: "Â¿A dÃ³nde deberÃ­as ir para comprar periÃ³dicos y revistas?" }, options: ["Librairie", "Papeterie", "Maison de la presse", "Disquaire"], answer: "Maison de la presse" },
                { question: { zh: "å”®å–çš®åŒ…ã€çš®å¸¦çš„å•†åº—æ˜¯ï¼Ÿ", en: "A shop that sells leather bags and belts is a?", es: "Â¿Una tienda que vende bolsos y cinturones de cuero es una?" }, options: ["Bijouterie", "Maroquinerie", "Chapellerie", "Lingerie"], answer: "Maroquinerie" }
            ],
            [
                { question: { zh: "å» 'chez l'opticien' æ˜¯ä¸ºäº†ï¼Ÿ", en: "You go to 'chez l'opticien' to...?", es: "Â¿Vas a 'chez l'opticien' para...?" }, options: { zh: ["ä¹°ç©å…·", "ä¿®é‹", "é…çœ¼é•œ", "ä¹°è¯"], en: ["Buy toys", "Repair shoes", "Get glasses", "Buy medicine"], es: ["Comprar juguetes", "Reparar zapatos", "Comprar gafas", "Comprar medicinas"] }, answer: "Get glasses", answer_es: "Comprar gafas", answer_zh: "é…çœ¼é•œ" },
                { question: { zh: "å“ªä¸ªè¯é€šå¸¸æŒ‡å°è€Œæ—¶å°šçš„åº—é“ºï¼Ÿ", en: "Which word usually refers to a small, fashionable shop?", es: "Â¿QuÃ© palabra se refiere generalmente a una tienda pequeÃ±a y de moda?" }, options: ["Grand magasin", "SupermarchÃ©", "Boutique", "HypermarchÃ©"], answer: "Boutique" },
                { question: { zh: "å”®å–é‚®ç¥¨å’Œå½©ç¥¨çš„åœ°æ–¹é€šå¸¸æ˜¯ï¼Ÿ", en: "A place that sells stamps and lottery tickets is usually a?", es: "Â¿Un lugar que vende sellos y billetes de loterÃ­a es generalmente un?" }, options: ["Banque", "Poste", "Tabac", "Agence de voyages"], answer: "Tabac" },
                { question: { zh: "é€è¡£æœå»å¹²æ´—ï¼Œåº”è¯¥æ‰¾ï¼Ÿ", en: "To get clothes dry-cleaned, you should look for a?", es: "Para llevar la ropa a la tintorerÃ­a, Â¿deberÃ­as buscar un?" }, options: ["Cordonnerie", "Serrurerie", "Pressing", "Teinturerie"], answer: "Pressing" },
                { question: { zh: "'PÃ¢tisserie' ä¸»è¦å”®å–ä»€ä¹ˆï¼Ÿ", en: "What does a 'PÃ¢tisserie' mainly sell?", es: "Â¿QuÃ© vende principalmente una 'PÃ¢tisserie'?" }, options: { zh: ["æ³•æ£é¢åŒ…", "ç²¾è‡´ç³•ç‚¹", "æµ·é²œ", "å¥¶é…ª"], en: ["Baguettes", "Fine pastries", "Seafood", "Cheese"], es: ["Baguettes", "Pasteles finos", "Mariscos", "Queso"] }, answer: "Fine pastries", answer_es: "Pasteles finos", answer_zh: "ç²¾è‡´ç³•ç‚¹" }
            ]
        ];
        
        const templateData = [
            {
                title: { zh: "æ¨¡æ¿ä¸€ï¼šé—®å€™ä¸è¡¨è¾¾éœ€æ±‚", en: "Template 1: Greeting & Stating Needs", es: "Plantilla 1: Saludar y Expresar Necesidades" },
                lines: [
                    { fr: "Bonjour / Bonsoir, Monsieur / Madame.", trans: { zh: "ä½ å¥½ / æ™šä¸Šå¥½ï¼Œå…ˆç”Ÿ / å¥³å£«ã€‚", en: "Hello / Good evening, Sir / Madam.", es: "Buenos dÃ­as / Buenas tardes, SeÃ±or / SeÃ±ora." } },
                    { fr: "Je cherche...", trans: { zh: "æˆ‘åœ¨æ‰¾â€¦â€¦ (ç”¨äºå¯»æ‰¾ç‰¹å®šç‰©å“)", en: "I am looking for... (for a specific item)", es: "Estoy buscando... (para un artÃ­culo especÃ­fico)" } },
                    { fr: "Je voudrais...", trans: { zh: "æˆ‘æƒ³è¦â€¦â€¦ (ç”¨äºæå‡ºè¯·æ±‚)", en: "I would like... (to ask for something)", es: "Quisiera... (para pedir algo)" } },
                    { fr: "Je regarde juste, merci.", trans: { zh: "æˆ‘åªæ˜¯éšä¾¿çœ‹çœ‹ï¼Œè°¢è°¢ã€‚", en: "I'm just looking, thank you.", es: "Solo estoy mirando, gracias." } }
                ]
            },
            {
                title: { zh: "æ¨¡æ¿äºŒï¼šè¯¢é—®ä¿¡æ¯", en: "Template 2: Asking for Information", es: "Plantilla 2: Pedir InformaciÃ³n" },
                lines: [
                    { fr: "Combien Ã§a coÃ»te ? / C'est combien ?", trans: { zh: "è¿™ä¸ªå¤šå°‘é’±ï¼Ÿ", en: "How much does this cost?", es: "Â¿CuÃ¡nto cuesta esto?" } },
                    { fr: "Vous avez la taille au-dessus / en-dessous ?", trans: { zh: "æ‚¨æœ‰å¤§ä¸€å·/å°ä¸€å·çš„å—ï¼Ÿ", en: "Do you have a size up / down?", es: "Â¿Tiene una talla mÃ¡s grande / mÃ¡s pequeÃ±a?" } },
                    { fr: "Vous avez d'autres couleurs ?", trans: { zh: "æ‚¨æœ‰å…¶ä»–é¢œè‰²å—ï¼Ÿ", en: "Do you have other colors?", es: "Â¿Tiene otros colores?" } },
                    { fr: "Est-ce que je peux essayer ?", trans: { zh: "æˆ‘å¯ä»¥è¯•ä¸€ä¸‹å—ï¼Ÿ", en: "Can I try it on?", es: "Â¿Puedo probÃ¡rmelo?" } }
                ]
            },
            {
                title: { zh: "æ¨¡æ¿ä¸‰ï¼šåšå‡ºå†³å®š", en: "Template 3: Making a Decision", es: "Plantilla 3: Tomar una DecisiÃ³n" },
                lines: [
                    { fr: "Je le / la prends.", trans: { zh: "å¥½çš„ï¼Œæˆ‘è¦äº†ã€‚", en: "I'll take it.", es: "Me lo/la llevo." } },
                    { fr: "Je vais rÃ©flÃ©chir, merci.", trans: { zh: "æˆ‘å†è€ƒè™‘ä¸€ä¸‹ï¼Œè°¢è°¢ã€‚", en: "I'll think about it, thank you.", es: "Lo pensarÃ©, gracias." } },
                    { fr: "Non, merci, Ã§a n'ira pas.", trans: { zh: "ä¸äº†ï¼Œè°¢è°¢ï¼Œè¿™ä¸ªä¸åˆé€‚ã€‚", en: "No, thank you, it won't work.", es: "No, gracias, no me sirve." } }
                ]
            },
            {
                title: { zh: "æ¨¡æ¿å››ï¼šæ”¯ä»˜", en: "Template 4: Payment", es: "Plantilla 4: Pago" },
                lines: [
                    { fr: "Je peux payer par carte (bancaire) ?", trans: { zh: "æˆ‘å¯ä»¥åˆ·å¡å—ï¼Ÿ", en: "Can I pay by card?", es: "Â¿Puedo pagar con tarjeta?" } },
                    { fr: "Je vais payer en espÃ¨ces.", trans: { zh: "æˆ‘ç”¨ç°é‡‘æ”¯ä»˜ã€‚", en: "I'll pay in cash.", es: "PagarÃ© en efectivo." } },
                    { fr: "Ce sera tout, merci.", trans: { zh: "å°±è¿™äº›ï¼Œè°¢è°¢ã€‚", en: "That will be all, thank you.", es: "Eso es todo, gracias." } }
                ]
            },
            {
                title: { zh: "æ¨¡æ¿äº”ï¼šå‘Šåˆ«", en: "Template 5: Saying Goodbye", es: "Plantilla 5: Despedirse" },
                lines: [
                    { fr: "Merci, au revoir.", trans: { zh: "è°¢è°¢ï¼Œå†è§ã€‚", en: "Thank you, goodbye.", es: "Gracias, adiÃ³s." } },
                    { fr: "Merci, bonne journÃ©e / bonne soirÃ©e.", trans: { zh: "è°¢è°¢ï¼Œç¥æ‚¨æœ‰æ„‰å¿«çš„ä¸€å¤©/æ™šä¸Šã€‚", en: "Thank you, have a good day / evening.", es: "Gracias, que tenga un buen dÃ­a / una buena tarde." } }
                ]
            }
        ];

        // --- æ ¸å¿ƒåŠŸèƒ½å‡½æ•° ---
        function changeLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.lang = lang;
            document.getElementById('html-title').textContent = translations[lang].htmlTitle;
            document.getElementById('main-title').textContent = translations[lang].mainTitle;
            document.getElementById('tab-shops').textContent = translations[lang].tabShops;
            document.getElementById('tab-quiz').textContent = translations[lang].tabQuiz;
            document.getElementById('tab-templates').textContent = translations[lang].tabTemplates;
            document.getElementById('quiz-title').textContent = translations[lang].quizTitle;
            document.getElementById('submit-quiz').textContent = translations[lang].submitQuiz;
            document.getElementById('reset-quiz').textContent = translations[lang].resetQuiz;
            document.getElementById('change-quiz').textContent = translations[lang].changeQuiz;
            document.getElementById('footer-text').innerHTML = translations[lang].footerText;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.lang-btn[onclick="changeLanguage('${lang}')"]`).classList.add('active');
            loadShops();
            loadQuiz();
            loadTemplates();
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`).classList.add('active');
        }

        function loadShops() {
            shopsContainer.innerHTML = '';
            shopData.forEach(categoryData => {
                const card = document.createElement('div');
                card.className = 'card p-6 md:p-8';
                const title = document.createElement('h2');
                title.className = 'text-xl md:text-2xl font-bold mb-6 text-gray-700';
                title.textContent = categoryData.category[currentLanguage];
                card.appendChild(title);
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-4';
                categoryData.items.forEach(item => {
                    const p = document.createElement('p');
                    const translationText = item.translations[currentLanguage];
                    if (item.note && item.note[currentLanguage]) {
                        p.innerHTML = `<span class="tooltip-trigger" data-note="${item.note[currentLanguage]}">${item.fr}</span> - ${translationText}`;
                    } else {
                        p.innerHTML = `<strong class="text-blue-600">${item.fr}</strong> - ${translationText}`;
                    }
                    grid.appendChild(p);
                });
                card.appendChild(grid);
                shopsContainer.appendChild(card);
            });
        }

        function loadQuiz() {
            const quizData = allQuizData[currentQuizSetIndex];
            quizContainer.innerHTML = '';
            resultsContainer.innerHTML = '';
            userAnswers = {};
            submitButton.style.display = 'inline-block';
            quizData.forEach((quizItem, index) => {
                const questionElement = document.createElement('div');
                questionElement.className = 'question-block';
                const questionText = document.createElement('p');
                questionText.className = 'font-semibold mb-3';
                questionText.textContent = `${index + 1}. ${quizItem.question[currentLanguage]}`;
                questionElement.appendChild(questionText);
                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'space-y-2';
                let options = quizItem.options[currentLanguage] || quizItem.options;
                options.forEach(option => {
                    const optionButton = document.createElement('button');
                    optionButton.className = 'quiz-option block w-full text-left p-3 border rounded-lg transition-colors';
                    optionButton.textContent = option;
                    optionButton.onclick = () => selectOption(index, option, optionButton);
                    optionsContainer.appendChild(optionButton);
                });
                questionElement.appendChild(optionsContainer);
                quizContainer.appendChild(questionElement);
            });
        }
        
        function loadTemplates() {
            templatesContainer.innerHTML = '<div class="space-y-8"></div>';
            const container = templatesContainer.querySelector('.space-y-8');
            templateData.forEach(template => {
                const card = document.createElement('div');
                card.className = 'card p-6 md:p-8';
                const title = document.createElement('h3');
                title.className = 'text-xl font-bold mb-4 text-blue-600';
                title.textContent = template.title[currentLanguage];
                card.appendChild(title);
                const content = document.createElement('div');
                content.className = 'space-y-4';
                template.lines.forEach(line => {
                    const p = document.createElement('p');
                    p.innerHTML = `<strong class="text-gray-800">${line.fr}</strong> - ${line.trans[currentLanguage]}`;
                    content.appendChild(p);
                });
                card.appendChild(content);
                container.appendChild(card);
            });
        }

        function selectOption(questionIndex, option, buttonElement) {
            userAnswers[questionIndex] = option;
            const parent = buttonElement.parentElement;
            parent.querySelectorAll('.quiz-option').forEach(btn => btn.classList.remove('selected'));
            buttonElement.classList.add('selected');
        }

        submitButton.addEventListener('click', () => {
            let score = 0;
            const quizData = allQuizData[currentQuizSetIndex];
            const questionBlocks = document.querySelectorAll('.question-block');
            quizData.forEach((quizItem, index) => {
                const options = questionBlocks[index].querySelectorAll('.quiz-option');
                const correctAnswer = quizItem[`answer_${currentLanguage}`] || quizItem.answer;
                options.forEach(optionButton => {
                    optionButton.disabled = true;
                    if (optionButton.textContent === correctAnswer) {
                        optionButton.classList.add('correct');
                    }
                    if (optionButton.classList.contains('selected') && optionButton.textContent !== correctAnswer) {
                         optionButton.classList.add('incorrect');
                    }
                });
                if (userAnswers[index] === correctAnswer) {
                    score++;
                }
            });
            resultsContainer.textContent = translations[currentLanguage].quizResultText(score, quizData.length);
            if (score === quizData.length) {
                resultsContainer.textContent += " " + translations[currentLanguage].quizCompleteText;
                resultsContainer.style.color = '#22c55e';
            } else {
                 resultsContainer.style.color = '#3b82f6';
            }
            submitButton.style.display = 'none';
        });
        
        resetButton.addEventListener('click', loadQuiz);

        changeQuizButton.addEventListener('click', () => {
            currentQuizSetIndex = (currentQuizSetIndex + 1) % allQuizData.length;
            loadQuiz();
        });

        function openModal(note) {
            modalText.textContent = note;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }
        function closeModal() {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
        shopsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('tooltip-trigger')) {
                openModal(e.target.dataset.note);
            }
        });
        closeModalBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

        window.onload = () => {
            changeLanguage(currentLanguage);
        };
    </script>
</body>
</html>
